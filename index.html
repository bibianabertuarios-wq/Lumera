<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumera - Your Wellness Companion</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Lato', sans-serif; }
        h1, h2, h3 { font-family: 'Playfair Display', serif; }
        .gradient-text { background: linear-gradient(135deg, #9333ea 0%, #ec4899 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const SUPABASE_URL = 'https://pyekwpmbdnmglrjieexc.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB5ZWt3cG1iZG5tZ2xyamllZXhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0ODM0OTgsImV4cCI6MjA4MTA1OTQ5OH0.zQl7GF3E6BhDqW3bEMixAbdDcOsW8BsFOBeAGa-5bzY';
        const BACKEND_URL = 'https://lumera-backend-production.up.railway.app';
        const STRIPE_KEY = 'pk_test_51Sejh162SZ6DF120ogS0E67ngoK4aE2C2xRW0pMJcfwWxaQq1UJ7kj9nKbmZQ8h0v3lG';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        const stripe = window.Stripe(STRIPE_KEY);
        const PRICES = {
            latam: { id: 'price_1Sejoa62SZ6DF12Ox5sU1Y9v', price: '$4.99' },
            emea: { id: 'price_1Sejso62SZ6DF12O5eSsNiGQ', price: '‚Ç¨4.99' },
            usa: { id: 'price_1Sejuh62SZ6DF12OUR0k19Rd', price: '$6.99' }
        };

        const LumeraApp = () => {
            const [language, setLanguage] = useState('es');
            const [darkMode, setDarkMode] = useState(false);
            const [session, setSession] = useState(null);
            const [authMode, setAuthMode] = useState('login');
            const [authData, setAuthData] = useState({ email: '', password: '' });
            const [showAuth, setShowAuth] = useState(true); // FORZAR TRUE AL INICIO
            const [loading, setLoading] = useState(true);
            const [currentUser, setCurrentUser] = useState(null);
            const [currentPage, setCurrentPage] = useState('home');
            const [showQuiz, setShowQuiz] = useState(false);
            const [quizStep, setQuizStep] = useState(1);
            const [symptoms, setSymptoms] = useState([]);
            const [periodLog, setPeriodLog] = useState([]);
            const [userMessages, setUserMessages] = useState([]);
            const [exerciseGoal, setExerciseGoal] = useState('hormonal');
            const [userRegion, setUserRegion] = useState('LATAM');
            const [showTutorial, setShowTutorial] = useState(false);
            
            const [formData, setFormData] = useState({
                profileName: '',
                age: '',
                height: '',
                weight: '',
                conditions: [],
                activityLevel: '',
                activityMultiplier: 1.2
            });

            const [symptomForm, setSymptomForm] = useState({
                sleep: 5,
                energy: 5,
                mood: 5,
                hotFlashes: 0,
                anxiety: 5,
                date: new Date().toISOString().split('T')[0]
            });

            const [periodForm, setPeriodForm] = useState({
                intensity: 5,
                duration: 5,
                symptoms: '',
                date: new Date().toISOString().split('T')[0]
            });

            const [communityMessage, setCommunityMessage] = useState('');

            // REFS PARA GR√ÅFICOS
            const chartRefSleep = useRef(null);
            const chartRefEnergy = useRef(null);
            const chartRefMood = useRef(null);
            const chartRefHotFlashes = useRef(null);
            const chartRefPeriod = useRef(null);

            const chartsRef = useRef({
                sleep: null,
                energy: null,
                mood: null,
                hotFlashes: null,
                period: null
            });

            const t = {
                es: {
                    app_name: 'Lumera',
                    home: 'Inicio',
                    nutrition: 'Nutrici√≥n',
                    exercise: 'Ejercicio',
                    symptoms: 'S√≠ntomas',
                    period: 'Per√≠odo',
                    myths: 'Mitos',
                    tips: 'Consejos',
                    workshops: 'Talleres',
                    community: 'Comunidad',
                    save: 'Guardar',
                    cancel: 'Cancelar',
                    next: 'Siguiente',
                    exit: 'Salir',
                    ingredients: 'Ingredientes',
                    preparation: 'Preparaci√≥n',
                    why: 'Por qu√©',
                    benefits: 'Beneficios',
                    day: 'D√≠a',
                    breakfast: 'Desayuno',
                    lunch: 'Almuerzo',
                    dinner: 'Cena',
                    snack: 'Snack',
                    personalized: 'Personalizado para ti',
                    download: 'Descargar',
                    addRecord: 'Registrar',
                    strength: 'Ganar Fuerza',
                    weightLoss: 'Perder Peso',
                    hormonal: 'Equilibrio Hormonal',
                    activityLevel: 'Nivel de actividad f√≠sica',
                    activityQuestion: '¬øCu√°l es tu nivel de actividad f√≠sica actual?',
                    activitySedentary: 'Sedentaria',
                    activitySedentaryDesc: 'Poco o ning√∫n ejercicio',
                    activityLight: 'Ligeramente activa',
                    activityLightDesc: 'Ejercicio ligero 1-3 d√≠as/semana',
                    activityModerate: 'Moderadamente activa',
                    activityModerateDesc: 'Ejercicio moderado 3-5 d√≠as/semana',
                    activityVery: 'Muy activa',
                    activityVeryDesc: 'Ejercicio intenso 6-7 d√≠as/semana',
                    activityExtreme: 'Extremadamente activa',
                    activityExtremeDesc: 'Ejercicio muy intenso, trabajo f√≠sico'
                },
                en: {
                    app_name: 'Lumera',
                    home: 'Home',
                    nutrition: 'Nutrition',
                    exercise: 'Exercise',
                    symptoms: 'Symptoms',
                    period: 'Period',
                    myths: 'Myths',
                    tips: 'Tips',
                    workshops: 'Workshops',
                    community: 'Community',
                    save: 'Save',
                    cancel: 'Cancel',
                    next: 'Next',
                    exit: 'Exit',
                    ingredients: 'Ingredients',
                    preparation: 'Preparation',
                    why: 'Why',
                    benefits: 'Benefits',
                    day: 'Day',
                    breakfast: 'Breakfast',
                    lunch: 'Lunch',
                    dinner: 'Dinner',
                    snack: 'Snack',
                    personalized: 'Personalized for you',
                    download: 'Download',
                    addRecord: 'Record',
                    strength: 'Build Strength',
                    weightLoss: 'Lose Weight',
                    hormonal: 'Hormonal Balance',
                    activityLevel: 'Physical activity level',
                    activityQuestion: 'What is your current physical activity level?',
                    activitySedentary: 'Sedentary',
                    activitySedentaryDesc: 'Little or no exercise',
                    activityLight: 'Lightly active',
                    activityLightDesc: 'Light exercise 1-3 days/week',
                    activityModerate: 'Moderately active',
                    activityModerateDesc: 'Moderate exercise 3-5 days/week',
                    activityVery: 'Very active',
                    activityVeryDesc: 'Intense exercise 6-7 days/week',
                    activityExtreme: 'Extremely active',
                    activityExtremeDesc: 'Very intense exercise, physical work'
                }
            };

            // CARGAR DATOS
            useEffect(() => {
                // IMPORTANTE: Supabase es la √∫nica fuente de verdad
                supabase.auth.getSession().then(({ data: { session } }) => {
                    setSession(session);
                    
                    if (session) {
                        // Usuario autenticado, cargar perfil desde Supabase
                        supabase.from('user_profiles').select('*').eq('user_id', session.user.id).single()
                            .then(({ data, error }) => {
                                if (data) {
                                    // Perfil existe, cargar app
                                    setCurrentUser(data);
                                    setShowAuth(false);
                                    setShowQuiz(false);
                                    // LocalStorage solo como cach√©
                                    localStorage.setItem('lumeraUser', JSON.stringify(data));
                                } else {
                                    // Usuario sin perfil, mostrar quiz
                                    console.log('Usuario autenticado pero sin perfil, mostrando quiz');
                                    setShowAuth(false);
                                    setShowQuiz(true);
                                }
                                setLoading(false);
                            })
                            .catch((err) => {
                                console.error('Error cargando perfil:', err);
                                setShowQuiz(true);
                                setShowAuth(false);
                                setLoading(false);
                            });
                    } else {
                        // Sin sesi√≥n v√°lida, forzar login
                        console.log('Sin sesi√≥n v√°lida, mostrando auth');
                        setCurrentUser(null);
                        localStorage.removeItem('lumeraUser'); // Limpiar cach√©
                        setShowAuth(true);
                        setShowQuiz(false);
                        setLoading(false);
                    }
                });

                // Listener de cambios de autenticaci√≥n
                const { data: { subscription } } = supabase.auth.onAuthStateChange((event, session) => {
                    console.log('Auth state change:', event);
                    setSession(session);
                    
                    if (session) {
                        supabase.from('user_profiles').select('*').eq('user_id', session.user.id).single()
                            .then(({ data }) => {
                                if (data) {
                                    setCurrentUser(data);
                                    setShowAuth(false);
                                    setShowQuiz(false);
                                    localStorage.setItem('lumeraUser', JSON.stringify(data));
                                } else {
                                    setShowQuiz(true);
                                    setShowAuth(false);
                                }
                            });
                    } else {
                        // Sesi√≥n cerrada
                        setCurrentUser(null);
                        localStorage.removeItem('lumeraUser');
                        setShowAuth(true);
                        setShowQuiz(false);
                    }
                });
                
                // Cargar preferencias UI desde localStorage
                const savedDark = localStorage.getItem('lumeraDark');
                const savedLang = localStorage.getItem('lumeraLang');
                
                if (savedDark) setDarkMode(JSON.parse(savedDark));
                if (savedLang) setLanguage(savedLang);

                return () => subscription.unsubscribe();
            }, []);

            // GUARDAR DATOS
            useEffect(() => {
                localStorage.setItem('lumeraDark', JSON.stringify(darkMode));
                localStorage.setItem('lumeraLang', language);
                localStorage.setItem('lumeraSymptoms', JSON.stringify(symptoms));
                localStorage.setItem('lumeraPeriod', JSON.stringify(periodLog));
                localStorage.setItem('lumeraMessages', JSON.stringify(userMessages));
            }, [darkMode, language, symptoms, periodLog, userMessages]);

            // GR√ÅFICOS DE S√çNTOMAS
            useEffect(() => {
                if (symptoms.length === 0) return;

                const labels = symptoms.map(s => s.date).slice(-14);
                const sleepData = symptoms.map(s => s.sleep).slice(-14);
                const energyData = symptoms.map(s => s.energy).slice(-14);
                const moodData = symptoms.map(s => s.mood).slice(-14);
                const hotFlashesData = symptoms.map(s => s.hotFlashes).slice(-14);

                const chartOptions = {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: true } },
                    scales: { y: { beginAtZero: true, max: 10 } }
                };

                setTimeout(() => {
                    if (chartRefSleep.current && window.Chart) {
                        if (chartsRef.current.sleep) chartsRef.current.sleep.destroy();
                        chartsRef.current.sleep = new window.Chart(chartRefSleep.current, {
                            type: 'line',
                            data: {
                                labels: labels,
                                datasets: [{ label: language === 'es' ? 'Sue√±o' : 'Sleep', data: sleepData, borderColor: '#9333ea', backgroundColor: 'rgba(147,51,234,0.1)', borderWidth: 2, fill: true, tension: 0.4 }]
                            },
                            options: chartOptions
                        });
                    }

                    if (chartRefEnergy.current && window.Chart) {
                        if (chartsRef.current.energy) chartsRef.current.energy.destroy();
                        chartsRef.current.energy = new window.Chart(chartRefEnergy.current, {
                            type: 'line',
                            data: {
                                labels: labels,
                                datasets: [{ label: language === 'es' ? 'Energ√≠a' : 'Energy', data: energyData, borderColor: '#ec4899', backgroundColor: 'rgba(236,72,153,0.1)', borderWidth: 2, fill: true, tension: 0.4 }]
                            },
                            options: chartOptions
                        });
                    }

                    if (chartRefMood.current && window.Chart) {
                        if (chartsRef.current.mood) chartsRef.current.mood.destroy();
                        chartsRef.current.mood = new window.Chart(chartRefMood.current, {
                            type: 'line',
                            data: {
                                labels: labels,
                                datasets: [{ label: language === 'es' ? '√Ånimo' : 'Mood', data: moodData, borderColor: '#06b6d4', backgroundColor: 'rgba(6,182,212,0.1)', borderWidth: 2, fill: true, tension: 0.4 }]
                            },
                            options: chartOptions
                        });
                    }

                    if (chartRefHotFlashes.current && window.Chart) {
                        if (chartsRef.current.hotFlashes) chartsRef.current.hotFlashes.destroy();
                        chartsRef.current.hotFlashes = new window.Chart(chartRefHotFlashes.current, {
                            type: 'bar',
                            data: {
                                labels: labels,
                                datasets: [{ label: language === 'es' ? 'Sofocos' : 'Hot Flashes', data: hotFlashesData, backgroundColor: '#f97316', borderColor: '#ea580c', borderWidth: 1 }]
                            },
                            options: chartOptions
                        });
                    }
                }, 100);
            }, [symptoms, language]);

            // GR√ÅFICOS DE PER√çODO
            useEffect(() => {
                if (periodLog.length === 0) return;

                const labels = periodLog.map(p => p.date).slice(-12);
                const intensityData = periodLog.map(p => p.intensity).slice(-12);
                const durationData = periodLog.map(p => p.duration).slice(-12);

                const chartOptions = {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: true } },
                    scales: { y: { beginAtZero: true } }
                };

                setTimeout(() => {
                    if (chartRefPeriod.current && window.Chart) {
                        if (chartsRef.current.period) chartsRef.current.period.destroy();
                        chartsRef.current.period = new window.Chart(chartRefPeriod.current, {
                            type: 'bar',
                            data: {
                                labels: labels,
                                datasets: [
                                    { label: language === 'es' ? 'Intensidad' : 'Intensity', data: intensityData, backgroundColor: '#ec4899', borderColor: '#be185d', borderWidth: 1 },
                                    { label: language === 'es' ? 'Duraci√≥n (d√≠as)' : 'Duration (days)', data: durationData, backgroundColor: '#f97316', borderColor: '#c2410c', borderWidth: 1 }
                                ]
                            },
                            options: chartOptions
                        });
                    }
                }, 100);
            }, [periodLog, language]);

            // MEN√öS 7 D√çAS
            const getWeekMenus = () => {
                return {
                    es: {
                        lunes: [
                            { name: 'Avena con Bayas', meal: 'Desayuno', calories: 380, time: '10 min', ingredients: [{ name: 'Avena integral', qty: 50, unit: 'g', why: 'Fibra y saciedad' }, { name: 'Leche desnatada', qty: 200, unit: 'ml', why: 'Prote√≠na, calcio' }, { name: 'Ar√°ndanos', qty: 80, unit: 'g', why: 'Antioxidantes' }], steps: ['Calienta leche', 'Agrega avena', 'Cocina 8 min', 'A√±ade bayas'], why: 'Estabiliza glucosa y energ√≠a' },
                            { name: 'Ensalada Pollo y Quinoa', meal: 'Almuerzo', calories: 520, time: '20 min', ingredients: [{ name: 'Pechuga pollo', qty: 200, unit: 'g', why: 'Prote√≠na magra' }, { name: 'Quinoa cocida', qty: 100, unit: 'g', why: 'Prote√≠na completa' }], steps: ['Cocina pollo', 'Prepara quinoa', 'Mezcla todo'], why: 'Alto en prote√≠na estabiliza hormonas' },
                            { name: 'Lentejas Especiadas', meal: 'Cena', calories: 380, time: '30 min', ingredients: [{ name: 'Lentejas rojas', qty: 200, unit: 'g', why: 'Prote√≠na vegetal' }, { name: 'C√∫rcuma', qty: 0.5, unit: 'cucharadita', why: 'Antiinflamatorio' }], steps: ['Sofr√≠e cebolla', 'Agrega lentejas', 'Cocina 30 min'], why: 'Favorece sue√±o reparador' },
                            { name: 'Yogur Griego', meal: 'Snack', calories: 250, time: '5 min', ingredients: [{ name: 'Yogur griego', qty: 150, unit: 'g', why: 'Prote√≠na y probi√≥ticos' }, { name: 'Ar√°ndanos', qty: 80, unit: 'g', why: 'Antioxidantes' }], steps: ['Vierte yogur', 'A√±ade ar√°ndanos'], why: 'Snack nutritivo' }
                        ],
                        martes: [
                            { name: 'Huevos Revueltos', meal: 'Desayuno', calories: 340, time: '10 min', ingredients: [{ name: 'Huevos', qty: 2, unit: 'piezas', why: 'Prote√≠na completa' }], steps: ['Revuelve huevos'], why: 'Prote√≠na pura' },
                            { name: 'Salm√≥n al Horno', meal: 'Almuerzo', calories: 480, time: '20 min', ingredients: [{ name: 'Salm√≥n', qty: 200, unit: 'g', why: 'Omega-3' }], steps: ['Hornea salm√≥n'], why: 'Reduce inflamaci√≥n' },
                            { name: 'Tofu a la Plancha', meal: 'Cena', calories: 320, time: '15 min', ingredients: [{ name: 'Tofu firme', qty: 250, unit: 'g', why: 'Prote√≠na vegetal' }], steps: ['Sofr√≠e tofu'], why: 'Opci√≥n vegana' },
                            { name: 'Batido Verde', meal: 'Snack', calories: 200, time: '5 min', ingredients: [{ name: 'Espinacas', qty: 50, unit: 'g', why: 'Minerales' }], steps: ['Lic√∫a'], why: 'Snack refrescante' }
                        ],
                        miercoles: [
                            { name: 'Granola Casera', meal: 'Desayuno', calories: 380, time: '10 min', ingredients: [{ name: 'Granola', qty: 50, unit: 'g', why: 'Fibra' }], steps: ['Sirve'], why: 'Desayuno c√≥modo' },
                            { name: 'Pavo con Boniato', meal: 'Almuerzo', calories: 460, time: '25 min', ingredients: [{ name: 'Pechuga pavo', qty: 250, unit: 'g', why: 'Prote√≠na magra' }], steps: ['Cocina'], why: 'Comida completa' },
                            { name: 'Garbanzos al Horno', meal: 'Cena', calories: 360, time: '20 min', ingredients: [{ name: 'Garbanzos cocidos', qty: 250, unit: 'g', why: 'Prote√≠na vegetal' }], steps: ['Hornea'], why: 'Cena vegetariana' },
                            { name: 'Frutos Secos', meal: 'Snack', calories: 220, time: '2 min', ingredients: [{ name: 'Almendras', qty: 30, unit: 'g', why: 'Prote√≠na' }], steps: ['Sirve'], why: 'Snack energ√©tico' }
                        ],
                        jueves: [
                            { name: 'Pudding de Ch√≠a', meal: 'Desayuno', calories: 320, time: '8 min', ingredients: [{ name: 'Semillas ch√≠a', qty: 30, unit: 'g', why: 'Omega-3' }], steps: ['Mezcla'], why: 'Desayuno que hidrata' },
                            { name: 'At√∫n a la Plancha', meal: 'Almuerzo', calories: 500, time: '15 min', ingredients: [{ name: 'Filete at√∫n', qty: 200, unit: 'g', why: 'Omega-3' }], steps: ['Asa at√∫n'], why: 'Pescado azul' },
                            { name: 'Pollo al Horno', meal: 'Cena', calories: 400, time: '30 min', ingredients: [{ name: 'Muslo pollo', qty: 250, unit: 'g', why: 'Prote√≠na' }], steps: ['Hornea'], why: 'Cena reconfortante' },
                            { name: 'Manzana con Almendras', meal: 'Snack', calories: 200, time: '3 min', ingredients: [{ name: 'Manzana', qty: 1, unit: 'pieza', why: 'Fibra' }], steps: ['Sirve'], why: 'Snack dulce' }
                        ],
                        viernes: [
                            { name: 'Panqueques Integrales', meal: 'Desayuno', calories: 400, time: '20 min', ingredients: [{ name: 'Harina integral', qty: 100, unit: 'g', why: 'Fibra' }], steps: ['Cocina'], why: 'Desayuno festivo' },
                            { name: 'Merluza a la Sal', meal: 'Almuerzo', calories: 420, time: '25 min', ingredients: [{ name: 'Filete merluza', qty: 250, unit: 'g', why: 'Prote√≠na magra' }], steps: ['Hornea'], why: 'Pescado blanco' },
                            { name: 'Pasta de Verdura', meal: 'Cena', calories: 380, time: '20 min', ingredients: [{ name: 'Pasta integral', qty: 150, unit: 'g', why: 'Fibra' }], steps: ['Cuece'], why: 'Cl√°sico italiano' },
                            { name: 'Chocolate Oscuro', meal: 'Snack', calories: 200, time: '2 min', ingredients: [{ name: 'Chocolate 85%', qty: 30, unit: 'g', why: 'Antioxidantes' }], steps: ['Sirve'], why: 'Snack gourmet' }
                        ],
                        sabado: [
                            { name: 'Brunch Completo', meal: 'Desayuno', calories: 450, time: '25 min', ingredients: [{ name: 'Huevos', qty: 2, unit: 'piezas', why: 'Prote√≠na' }], steps: ['Fr√≠e'], why: 'Brunch italiano' },
                            { name: 'Carne Magra', meal: 'Almuerzo', calories: 520, time: '20 min', ingredients: [{ name: 'Carne magra', qty: 250, unit: 'g', why: 'Prote√≠na' }], steps: ['Asa'], why: 'Prote√≠na fuerte' },
                            { name: 'Ratatouille', meal: 'Cena', calories: 300, time: '30 min', ingredients: [{ name: 'Verduras variadas', qty: 400, unit: 'g', why: 'Vitaminas' }], steps: ['Sofr√≠e'], why: 'Cena francesa' },
                            { name: 'T√© con Galletas', meal: 'Snack', calories: 180, time: '5 min', ingredients: [{ name: 'T√© verde', qty: 250, unit: 'ml', why: 'Antioxidantes' }], steps: ['Prepara'], why: 'Merienda acogedora' }
                        ],
                        domingo: [
                            { name: 'Smoothie Bowl', meal: 'Desayuno', calories: 420, time: '10 min', ingredients: [{ name: 'Ar√°ndanos', qty: 100, unit: 'g', why: 'Antioxidantes' }], steps: ['Mezcla'], why: 'Desayuno festivo' },
                            { name: 'Pollo Asado', meal: 'Almuerzo', calories: 500, time: '40 min', ingredients: [{ name: 'Pollo entero', qty: 400, unit: 'g', why: 'Prote√≠na' }], steps: ['Asa'], why: 'Almuerzo abundante' },
                            { name: 'Ceviche Vegetal', meal: 'Cena', calories: 320, time: '20 min', ingredients: [{ name: 'Palmitos', qty: 200, unit: 'g', why: 'Prote√≠na vegetal' }], steps: ['Mezcla'], why: 'Cena sofisticada' },
                            { name: 'Frutas de Temporada', meal: 'Snack', calories: 150, time: '5 min', ingredients: [{ name: 'Frutas variadas', qty: 300, unit: 'g', why: 'Vitaminas' }], steps: ['Sirve'], why: 'Snack natural' }
                        ]
                    },
                    en: {
                        lunes: [
                            { name: 'Oatmeal with Berries', meal: 'Desayuno', calories: 380, time: '10 min', ingredients: [{ name: 'Whole oats', qty: 50, unit: 'g', why: 'Fiber and satiety' }, { name: 'Skim milk', qty: 200, unit: 'ml', why: 'Protein, calcium' }, { name: 'Blueberries', qty: 80, unit: 'g', why: 'Antioxidants' }], steps: ['Heat milk', 'Add oats', 'Cook 8 min', 'Add berries'], why: 'Stabilizes glucose and energy' },
                            { name: 'Chicken and Quinoa Salad', meal: 'Almuerzo', calories: 520, time: '20 min', ingredients: [{ name: 'Chicken breast', qty: 200, unit: 'g', why: 'Lean protein' }, { name: 'Cooked quinoa', qty: 100, unit: 'g', why: 'Complete protein' }], steps: ['Cook chicken', 'Prepare quinoa', 'Mix all'], why: 'High protein stabilizes hormones' },
                            { name: 'Spiced Lentils', meal: 'Cena', calories: 380, time: '30 min', ingredients: [{ name: 'Red lentils', qty: 200, unit: 'g', why: 'Plant protein' }, { name: 'Turmeric', qty: 0.5, unit: 'tsp', why: 'Anti-inflammatory' }], steps: ['Saut√© onion', 'Add lentils', 'Cook 30 min'], why: 'Promotes restful sleep' },
                            { name: 'Greek Yogurt', meal: 'Snack', calories: 250, time: '5 min', ingredients: [{ name: 'Greek yogurt', qty: 150, unit: 'g', why: 'Protein and probiotics' }, { name: 'Blueberries', qty: 80, unit: 'g', why: 'Antioxidants' }], steps: ['Pour yogurt', 'Add berries'], why: 'Nutritious snack' }
                        ],
                        martes: [
                            { name: 'Scrambled Eggs', meal: 'Desayuno', calories: 340, time: '10 min', ingredients: [{ name: 'Eggs', qty: 2, unit: 'pcs', why: 'Complete protein' }], steps: ['Scramble eggs'], why: 'Pure protein' },
                            { name: 'Baked Salmon', meal: 'Almuerzo', calories: 480, time: '20 min', ingredients: [{ name: 'Salmon', qty: 200, unit: 'g', why: 'Omega-3' }], steps: ['Bake salmon'], why: 'Reduces inflammation' },
                            { name: 'Grilled Tofu', meal: 'Cena', calories: 320, time: '15 min', ingredients: [{ name: 'Firm tofu', qty: 250, unit: 'g', why: 'Plant protein' }], steps: ['Saut√© tofu'], why: 'Vegan option' },
                            { name: 'Green Smoothie', meal: 'Snack', calories: 200, time: '5 min', ingredients: [{ name: 'Spinach', qty: 50, unit: 'g', why: 'Minerals' }], steps: ['Blend'], why: 'Refreshing snack' }
                        ],
                        miercoles: [
                            { name: 'Homemade Granola', meal: 'Desayuno', calories: 380, time: '10 min', ingredients: [{ name: 'Granola', qty: 50, unit: 'g', why: 'Fiber' }], steps: ['Serve'], why: 'Convenient breakfast' },
                            { name: 'Turkey with Sweet Potato', meal: 'Almuerzo', calories: 460, time: '25 min', ingredients: [{ name: 'Turkey breast', qty: 250, unit: 'g', why: 'Lean protein' }], steps: ['Cook'], why: 'Complete meal' },
                            { name: 'Roasted Chickpeas', meal: 'Cena', calories: 360, time: '20 min', ingredients: [{ name: 'Cooked chickpeas', qty: 250, unit: 'g', why: 'Plant protein' }], steps: ['Roast'], why: 'Vegetarian dinner' },
                            { name: 'Mixed Nuts', meal: 'Snack', calories: 220, time: '2 min', ingredients: [{ name: 'Almonds', qty: 30, unit: 'g', why: 'Protein' }], steps: ['Serve'], why: 'Energetic snack' }
                        ],
                        jueves: [
                            { name: 'Chia Pudding', meal: 'Desayuno', calories: 320, time: '8 min', ingredients: [{ name: 'Chia seeds', qty: 30, unit: 'g', why: 'Omega-3' }], steps: ['Mix'], why: 'Hydrating breakfast' },
                            { name: 'Grilled Tuna', meal: 'Almuerzo', calories: 500, time: '15 min', ingredients: [{ name: 'Tuna fillet', qty: 200, unit: 'g', why: 'Omega-3' }], steps: ['Grill tuna'], why: 'Blue fish' },
                            { name: 'Baked Chicken', meal: 'Cena', calories: 400, time: '30 min', ingredients: [{ name: 'Chicken thigh', qty: 250, unit: 'g', why: 'Protein' }], steps: ['Bake'], why: 'Comforting dinner' },
                            { name: 'Apple with Almonds', meal: 'Snack', calories: 200, time: '3 min', ingredients: [{ name: 'Apple', qty: 1, unit: 'pc', why: 'Fiber' }], steps: ['Serve'], why: 'Sweet snack' }
                        ],
                        viernes: [
                            { name: 'Whole Wheat Pancakes', meal: 'Desayuno', calories: 400, time: '20 min', ingredients: [{ name: 'Whole wheat flour', qty: 100, unit: 'g', why: 'Fiber' }], steps: ['Cook'], why: 'Festive breakfast' },
                            { name: 'Salt-baked Hake', meal: 'Almuerzo', calories: 420, time: '25 min', ingredients: [{ name: 'Hake fillet', qty: 250, unit: 'g', why: 'Lean protein' }], steps: ['Bake'], why: 'White fish' },
                            { name: 'Vegetable Pasta', meal: 'Cena', calories: 380, time: '20 min', ingredients: [{ name: 'Whole wheat pasta', qty: 150, unit: 'g', why: 'Fiber' }], steps: ['Cook'], why: 'Italian classic' },
                            { name: 'Dark Chocolate', meal: 'Snack', calories: 200, time: '2 min', ingredients: [{ name: 'Dark chocolate 85%', qty: 30, unit: 'g', why: 'Antioxidants' }], steps: ['Serve'], why: 'Gourmet snack' }
                        ],
                        sabado: [
                            { name: 'Complete Brunch', meal: 'Desayuno', calories: 450, time: '25 min', ingredients: [{ name: 'Eggs', qty: 2, unit: 'pcs', why: 'Protein' }], steps: ['Fry'], why: 'Italian brunch' },
                            { name: 'Lean Meat', meal: 'Almuerzo', calories: 520, time: '20 min', ingredients: [{ name: 'Lean meat', qty: 250, unit: 'g', why: 'Protein' }], steps: ['Grill'], why: 'Strong protein' },
                            { name: 'Ratatouille', meal: 'Cena', calories: 300, time: '30 min', ingredients: [{ name: 'Mixed vegetables', qty: 400, unit: 'g', why: 'Vitamins' }], steps: ['Saut√©'], why: 'French dinner' },
                            { name: 'Tea with Cookies', meal: 'Snack', calories: 180, time: '5 min', ingredients: [{ name: 'Green tea', qty: 250, unit: 'ml', why: 'Antioxidants' }], steps: ['Prepare'], why: 'Cozy afternoon' }
                        ],
                        domingo: [
                            { name: 'Smoothie Bowl', meal: 'Desayuno', calories: 420, time: '10 min', ingredients: [{ name: 'Blueberries', qty: 100, unit: 'g', why: 'Antioxidants' }], steps: ['Mix'], why: 'Festive breakfast' },
                            { name: 'Roast Chicken', meal: 'Almuerzo', calories: 500, time: '40 min', ingredients: [{ name: 'Whole chicken', qty: 400, unit: 'g', why: 'Protein' }], steps: ['Roast'], why: 'Abundant lunch' },
                            { name: 'Vegetable Ceviche', meal: 'Cena', calories: 320, time: '20 min', ingredients: [{ name: 'Hearts of palm', qty: 200, unit: 'g', why: 'Plant protein' }], steps: ['Mix'], why: 'Sophisticated dinner' },
                            { name: 'Seasonal Fruits', meal: 'Snack', calories: 150, time: '5 min', ingredients: [{ name: 'Mixed fruits', qty: 300, unit: 'g', why: 'Vitamins' }], steps: ['Serve'], why: 'Natural snack' }
                        ]
                    }
                };
            };

            // EJERCICIOS
            const getExercises = () => {
                const allExercises = {
                    strength: [
                        { name: 'Sentadillas', duration: '20 min', difficulty: 'Moderada', freq: '3x semana', day: language === 'es' ? 'Lunes' : 'Monday', why: language === 'es' ? 'Aumenta densidad √≥sea (1-3% anual). Previene osteoporosis crucial en esta etapa.' : 'Increases bone density (1-3% per year). Prevents osteoporosis critical at this stage.', science: language === 'es' ? 'Ejercicio de resistencia aumenta masa √≥sea m√°s que cardio. Pierdes 1% √≥seo anual sin ejercicio.' : 'Resistance exercise increases bone mass more than cardio. You lose 1% bone annually without exercise.' },
                        { name: language === 'es' ? 'Flexiones en Pared' : 'Wall Push-ups', duration: '15 min', difficulty: language === 'es' ? 'F√°cil-Moderada' : 'Easy-Moderate', freq: '2x semana', day: language === 'es' ? 'Mi√©rcoles' : 'Wednesday', why: language === 'es' ? 'Fortalece pecho, brazos y estabilizadores. Mejora postura.' : 'Strengthens chest, arms and stabilizers. Improves posture.', science: language === 'es' ? 'P√©rdida de estr√≥geno causa p√©rdida de 0.5-1% muscular anual. Ejercicio de resistencia ralentiza esto.' : 'Estrogen loss causes 0.5-1% muscle loss annually. Resistance exercise slows this.' },
                        { name: language === 'es' ? 'Levantamiento Mancernas' : 'Dumbbell Lifting', duration: '25 min', difficulty: 'Moderada', freq: '3x semana', day: language === 'es' ? 'Viernes' : 'Friday', why: language === 'es' ? 'Incrementa fuerza y masa muscular. Acelera metabolismo 5-7%.' : 'Increases strength and muscle mass. Accelerates metabolism 5-7%.', science: language === 'es' ? 'Cada kg de m√∫sculo quema 6 calor√≠as en reposo. Es tu aliado metabolismo en esta etapa.' : 'Each kg of muscle burns 6 calories at rest. It\'s your metabolism ally at this stage.' },
                        { name: language === 'es' ? 'Planchas Abdominales' : 'Planks', duration: '10 min', difficulty: 'Moderada', freq: '3x semana', day: language === 'es' ? 'Martes' : 'Tuesday', why: language === 'es' ? 'Fortalece core. Mejora estabilidad y postura.' : 'Strengthens core. Improves stability and posture.', science: language === 'es' ? 'Core fuerte previene ca√≠das (comunes en mujeres 40-55) y reduce dolor de espalda 60%.' : 'Strong core prevents falls (common in 40-55 year old women) and reduces back pain 60%.' },
                        { name: language === 'es' ? 'Desplantes' : 'Lunges', duration: '20 min', difficulty: 'Moderada', freq: '2x semana', day: language === 'es' ? 'Jueves' : 'Thursday', why: language === 'es' ? 'Trabaja piernas y equilibrio. Functional para vida diaria.' : 'Works legs and balance. Functional for daily life.', science: language === 'es' ? 'Mejora propiocepci√≥n. Previene lesiones por ca√≠das que son 3x m√°s frecuentes en esta etapa.' : 'Improves proprioception. Prevents fall injuries which are 3x more frequent at this stage.' },
                        { name: language === 'es' ? 'Remo con Banda' : 'Rowing with Band', duration: '15 min', difficulty: language === 'es' ? 'F√°cil-Moderada' : 'Easy-Moderate', freq: '2x semana', day: language === 'es' ? 'S√°bado' : 'Saturday', why: language === 'es' ? 'Fortalece espalda. Mejora postura que se desmorona con cambios hormonales.' : 'Strengthens back. Improves posture that weakens with hormonal changes.', science: language === 'es' ? 'Estr√≥geno soportaba musculatura. Sin √©l, necesitas refuerzo activo. Remo restaura alineaci√≥n.' : 'Estrogen supported muscles. Without it, you need active reinforcement. Rowing restores alignment.' }
                    ],
                    weightLoss: [
                        { name: language === 'es' ? 'Caminata R√°pida' : 'Brisk Walking', duration: '30 min', difficulty: language === 'es' ? 'F√°cil' : 'Easy', freq: '5-7x semana', day: language === 'es' ? 'Diariamente' : 'Daily', why: language === 'es' ? 'Quema 200-300 calor√≠as. Accesible, bajo impacto, social.' : 'Burns 200-300 calories. Accessible, low impact, social.', science: language === 'es' ? 'Cardio moderado mejora sensibilidad insul√≠nica (baja en esta etapa). Reduce sofocos 30-40%.' : 'Moderate cardio improves insulin sensitivity (low at this stage). Reduces hot flashes 30-40%.' },
                        { name: language === 'es' ? 'Bicicleta Est√°tica' : 'Stationary Bike', duration: '30 min', difficulty: 'Moderada', freq: '3-4x semana', day: language === 'es' ? 'Lunes, Mi√©rcoles, Viernes' : 'Mon, Wed, Fri', why: language === 'es' ? 'Quema 250-400 calor√≠as. Sin impacto articular.' : 'Burns 250-400 calories. No joint impact.', science: language === 'es' ? 'Cardio aer√≥bico reduce grasa visceral (la m√°s peligrosa). Disminuye riesgo cardiovascular 35%.' : 'Aerobic cardio reduces visceral fat (the most dangerous). Reduces cardiovascular risk 35%.' },
                        { name: 'HIIT (Intervalos)', duration: '20 min', difficulty: language === 'es' ? 'Alta' : 'High', freq: '2x semana', day: language === 'es' ? 'Martes, Jueves' : 'Tue, Thu', why: language === 'es' ? 'M√°xima quema cal√≥rica en m√≠nimo tiempo. Efecto EPOC (metabolismo acelerado 24h).' : 'Maximum calorie burn in minimum time. EPOC effect (accelerated metabolism 24h).', science: language === 'es' ? 'HIIT aumenta EPOC 25-30%. Eficiente cuando tienes poco tiempo. Aumenta VO2 m√°x 15-25%.' : 'HIIT increases EPOC 25-30%. Efficient when time is limited. Increases max VO2 15-25%.' },
                        { name: language === 'es' ? 'Saltar la Cuerda' : 'Jump Rope', duration: '15 min', difficulty: 'Moderada', freq: '2x semana', day: language === 'es' ? 'Mi√©rcoles, S√°bado' : 'Wed, Sat', why: language === 'es' ? 'Quema 300+ calor√≠as/30 min. Tonifica piernas y core.' : 'Burns 300+ calories/30 min. Tones legs and core.', science: language === 'es' ? 'Saltar fortalece huesos (crucial ahora). Quema m√°s calor√≠as que correr en mismo tiempo.' : 'Jumping strengthens bones (crucial now). Burns more calories than running in same time.' },
                        { name: language === 'es' ? 'Nataci√≥n' : 'Swimming', duration: '45 min', difficulty: 'Moderada', freq: '2x semana', day: language === 'es' ? 'Lunes, Viernes' : 'Mon, Fri', why: language === 'es' ? 'Quema 300-400 calor√≠as. Bajo impacto. Trabaja todo el cuerpo.' : 'Burns 300-400 calories. Low impact. Works entire body.', science: language === 'es' ? 'Nataci√≥n trabaja 85% m√∫sculos. Mejora cardiovascular sin estr√©s articular. Reduce sofocos.' : 'Swimming works 85% of muscles. Improves cardiovascular health without joint stress. Reduces hot flashes.' },
                        { name: language === 'es' ? 'El√≠ptica' : 'Elliptical', duration: '25 min', difficulty: language === 'es' ? 'Moderada-Alta' : 'Moderate-High', freq: '3x semana', day: language === 'es' ? 'Martes, Jueves, Domingo' : 'Tue, Thu, Sun', why: language === 'es' ? 'Cardio intenso sin impacto. Quema 250-350 calor√≠as.' : 'Intense cardio without impact. Burns 250-350 calories.', science: language === 'es' ? 'Bajo impacto pero intenso. Ideal para perder peso sin lesionar articulaciones.' : 'Low impact but intense. Ideal for weight loss without joint injury.' }
                    ],
                    hormonal: [
                        { name: language === 'es' ? 'Yoga Suave' : 'Gentle Yoga', duration: '45 min', difficulty: language === 'es' ? 'F√°cil' : 'Easy', freq: '3x semana', day: language === 'es' ? 'Lunes, Mi√©rcoles, Viernes' : 'Mon, Wed, Fri', why: language === 'es' ? 'Reduce estr√©s que desencadena sofocos. Mejora sue√±o 40% en estudios.' : 'Reduces stress that triggers hot flashes. Improves sleep 40% in studies.', science: language === 'es' ? 'Cortisol elevado empeora s√≠ntomas. Yoga reduce cortisol 25%. Restaura balance nervioso.' : 'High cortisol worsens symptoms. Yoga reduces cortisol 25%. Restores nervous balance.' },
                        { name: 'Tai Chi', duration: '40 min', difficulty: language === 'es' ? 'F√°cil' : 'Easy', freq: '3x semana', day: language === 'es' ? 'Martes, Jueves, S√°bado' : 'Tue, Thu, Sat', why: language === 'es' ? 'Meditaci√≥n en movimiento. Mejora balance. Calma ansiedad.' : 'Moving meditation. Improves balance. Calms anxiety.', science: language === 'es' ? 'Estudios chinos: Tai Chi reduce sofocos 50%. Mejora sue√±o m√°s que otros ejercicios en mujeres.' : 'Chinese studies: Tai Chi reduces hot flashes 50%. Improves sleep more than other exercises in women.' },
                        { name: language === 'es' ? 'Pilates Core' : 'Pilates Core', duration: '30 min', difficulty: 'Moderada', freq: '2-3x semana', day: language === 'es' ? 'Lunes, Jueves' : 'Mon, Thu', why: language === 'es' ? 'Fortalece centro del cuerpo. Mejora postura. Estabilidad.' : 'Strengthens core body. Improves posture. Stability.', science: language === 'es' ? 'Fortalecimiento core reduce dolor de espalda 60%. Mejora postura que se cae con cambios hormonales.' : 'Core strengthening reduces back pain 60%. Improves posture that weakens with hormonal changes.' },
                        { name: language === 'es' ? 'Respiraci√≥n Consciente' : 'Conscious Breathing', duration: '15 min', difficulty: language === 'es' ? 'F√°cil' : 'Easy', freq: '4-5x semana', day: language === 'es' ? 'Diariamente' : 'Daily', why: language === 'es' ? 'Activa sistema nervioso parasimp√°tico (calma). Reduce sofocos instant√°neamente.' : 'Activates parasympathetic nervous system (calm). Reduces hot flashes instantly.', science: language === 'es' ? 'Respiraci√≥n 4-4-6 reduce cortisol 30%. En sofoco: respira y baja 50% intensidad.' : '4-4-6 breathing reduces cortisol 30%. In a hot flash: breathe and reduce intensity 50%.' },
                        { name: language === 'es' ? 'Caminata Meditativa' : 'Meditative Walk', duration: '30 min', difficulty: language === 'es' ? 'F√°cil' : 'Easy', freq: '5x semana', day: language === 'es' ? 'Diariamente' : 'Daily', why: language === 'es' ? 'Mezcla cardio suave con conexi√≥n emocional. Anti-ansiedad natural.' : 'Mixes light cardio with emotional connection. Natural anti-anxiety.', science: language === 'es' ? 'Naturaleza reduce cortisol 20 min. Caminar mejora serotonina (baja en perimenop√°usia).' : 'Nature reduces cortisol in 20 min. Walking improves serotonin (low in perimenopause).' },
                        { name: language === 'es' ? 'Estiramientos Profundos' : 'Deep Stretching', duration: '20 min', difficulty: language === 'es' ? 'F√°cil' : 'Easy', freq: '3x semana', day: language === 'es' ? 'Mi√©rcoles, Viernes, Domingo' : 'Wed, Fri, Sun', why: language === 'es' ? 'Libera tensi√≥n f√≠sica. Mejora flexibilidad.' : 'Releases physical tension. Improves flexibility.', science: language === 'es' ? 'Estr√©s se almacena en m√∫sculos. Estiramientos liberan tensi√≥n y reduce cortisol.' : 'Stress is stored in muscles. Stretching releases tension and reduces cortisol.' }
                    ]
                };
                return allExercises[exerciseGoal] || [];
            };

            // MITOS
            const getMythsAndTips = () => {
                return {
                    myths: language === 'es' ? [
                        { myth: 'Es una enfermedad que necesita medicaci√≥n', truth: 'Es una transici√≥n natural con opciones de manejo', science: 'La etapa entre 40-55 es biol√≥gicamente natural. El estr√≥geno desciende 90% pero NO es patolog√≠a sino cambio fisiol√≥gico.', action: 'Documenta s√≠ntomas 3 meses antes de considerar opciones m√©dicas' },
                        { myth: 'Los sofocos duran 10+ a√±os', truth: 'La mayor√≠a dura 5-8 a√±os. Intensidad disminuye con tiempo', science: 'Estudios: 65% resuelve en 8 a√±os, 90% en 10. Intensidad m√°xima en a√±os 1-3.', action: 'Ejercicio + sue√±o + estr√©s = sofocos 30-50% menos' },
                        { myth: 'Todas engordan', truth: 'El metabolismo baja pero es controlable', science: 'Metabolismo desciende 100-200 cal/d√≠a (5-8%). Pero ejercicio fuerza recupera 3-5%.', action: 'Aumenta prote√≠na a 1.2-1.6g/kg peso y entrena fuerza' },
                        { myth: 'La vida sexual termina', truth: 'Mejora para muchas sin miedo anticonceptivos', science: 'Sequedad tratable con lubricantes. Libertad anticonceptiva aumenta satisfacci√≥n.', action: 'Lubricante + comunicaci√≥n + paciencia = soluci√≥n' }
                    ] : [
                        { myth: 'It\'s a disease needing medication', truth: 'It\'s a natural transition with management options', science: 'The 40-55 stage is biologically natural. Not pathology but physiological change. Estrogen drops 90% but this is natural, not disease.', action: 'Document symptoms for 3 months before considering medical options' },
                        { myth: 'Hot flashes last 10+ years', truth: 'Most last 5-8 years. Intensity decreases over time', science: 'Studies: 65% resolves in 8 years, 90% in 10. Maximum intensity in years 1-3.', action: 'Exercise + sleep + stress management = 30-50% fewer hot flashes' },
                        { myth: 'Everyone gains weight', truth: 'Metabolism drops but it\'s controllable', science: 'Metabolism decreases 100-200 cal/day (5-8%). But strength exercise recovers 3-5%.', action: 'Increase protein to 1.2-1.6g/kg weight and train with resistance' },
                        { myth: 'Sexual life ends', truth: 'Improves for many without contraceptive fears', science: 'Dryness is treatable with lubricants. Freedom from contraception increases satisfaction.', action: 'Lubricant + communication + patience = solution' }
                    ],
                    tips: language === 'es' ? [
                        { emoji: 'üåô', title: 'Sue√±o 7-9 Horas', why: 'El sue√±o es reparaci√≥n. Tu cuerpo NECESITA m√°s sue√±o. Dormir 7+ horas reduce sofocos 40%.', how: '‚Ä¢ Misma hora siempre\n‚Ä¢ Sin pantallas tras las 21:00\n‚Ä¢ Habitaci√≥n 16-18¬∞C' },
                        { emoji: 'üí™', title: 'Movimiento 30+ min Diario', why: 'Ejercicio es medicina. Reduce sofocos, mejora sue√±o, preserva hueso. Incrementa serotonina.', how: '‚Ä¢ Cardio suave (caminar) 5 d√≠as\n‚Ä¢ Fuerza 2-3 d√≠as\n‚Ä¢ Flexibilidad (yoga) 2-3 d√≠as' },
                        { emoji: 'ü•ó', title: 'Nutrici√≥n Real No Dietas', why: 'Dietas restrictivas empeoran s√≠ntomas. Necesitas nutrientes para neurotransmisores.', how: '‚Ä¢ Prote√≠na CADA comida (30-40g)\n‚Ä¢ Come arco√≠ris\n‚Ä¢ Grasas omega-3' },
                        { emoji: '‚ú®', title: 'Respiraci√≥n Profunda 5 min', why: 'Activa parasimp√°tico (sistema calma). En sofoco: respira y baja 50% intensidad.', how: '‚Ä¢ Inhalaci√≥n 4 segundos\n‚Ä¢ Retenci√≥n 4 segundos\n‚Ä¢ Exhalaci√≥n 6 segundos' },
                        { emoji: 'üíú', title: 'Conexi√≥n Humana', why: 'Aislamiento amplifica ansiedad. Conexi√≥n reduce estr√©s 35%.', how: '‚Ä¢ Busca c√≠rculo de mujeres\n‚Ä¢ Habla sin tab√∫es\n‚Ä¢ Comparte miedos' }
                    ] : [
                        { emoji: 'üåô', title: 'Sleep 7-9 Hours', why: 'Sleep is repair. Your body NEEDS more sleep. Sleeping 7+ hours reduces hot flashes 40%.', how: '‚Ä¢ Same time always\n‚Ä¢ No screens after 9 PM\n‚Ä¢ Room 16-18¬∞C' },
                        { emoji: 'üí™', title: 'Movement 30+ min Daily', why: 'Exercise is medicine. Reduces hot flashes, improves sleep, preserves bone. Increases serotonin.', how: '‚Ä¢ Light cardio (walking) 5 days\n‚Ä¢ Strength 2-3 days\n‚Ä¢ Flexibility (yoga) 2-3 days' },
                        { emoji: 'ü•ó', title: 'Real Nutrition Not Diets', why: 'Restrictive diets worsen symptoms. You need nutrients for neurotransmitters.', how: '‚Ä¢ Protein EVERY meal (30-40g)\n‚Ä¢ Eat the rainbow\n‚Ä¢ Omega-3 fats' },
                        { emoji: '‚ú®', title: 'Deep Breathing 5 min', why: 'Activates parasympathetic (calm system). In hot flash: breathe and reduce intensity 50%.', how: '‚Ä¢ Inhale 4 seconds\n‚Ä¢ Hold 4 seconds\n‚Ä¢ Exhale 6 seconds' },
                        { emoji: 'üíú', title: 'Human Connection', why: 'Isolation amplifies anxiety. Connection reduces stress 35%.', how: '‚Ä¢ Find a circle of women\n‚Ä¢ Talk without taboos\n‚Ä¢ Share fears' }
                    ]
                };
            };

            // CUESTIONARIO
            // FUNCIONES AUTH Y PREMIUM
            const handleLogin = () => {
                supabase.auth.signInWithPassword({ email: authData.email, password: authData.password })
                    .then(({ error }) => { 
                        if (error) {
                            alert(error.message);
                        }
                        // El onAuthStateChange manejar√° el resto
                    });
            };
            
            const handleRegister = () => {
                supabase.auth.signUp({ email: authData.email, password: authData.password })
                    .then(({ error, data }) => {
                        if (error) {
                            alert(error.message);
                        } else if (data.session) {
                            // Registro exitoso con sesi√≥n inmediata
                            console.log('Registro exitoso, sesi√≥n creada');
                            // El onAuthStateChange mostrar√° el quiz autom√°ticamente
                        } else {
                            // Requiere confirmaci√≥n de email
                            alert(language === 'es' 
                                ? 'Revisa tu email para confirmar tu cuenta' 
                                : 'Check your email to confirm your account');
                        }
                    });
            };
            
            const handleLogout = () => {
                supabase.auth.signOut();
                localStorage.clear();
                setCurrentUser(null);
                setShowAuth(true);
            };
            
            const isPremium = () => currentUser?.subscription_status === 'active';
            
            const getRegion = () => {
                const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
                if (tz.includes('America')) return 'latam';
                if (tz.includes('Europe') || tz.includes('Africa')) return 'emea';
                return 'usa';
            };
            
            const handleSubscribe = () => {
                if (!session) { alert('Inicia sesi√≥n primero'); return; }
                fetch(`${BACKEND_URL}/create-checkout-session`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        priceId: PRICES[getRegion()].id,
                        userId: session.user.id,
                        userEmail: session.user.email
                    })
                }).then(r => r.json()).then(({ sessionId }) => {
                    stripe.redirectToCheckout({ sessionId });
                });
            };

            const renderQuiz = () => {
                if (quizStep === 1) {
                    return (
                        <div className={`min-h-screen ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-purple-100 to-pink-100'} flex items-center justify-center p-4`}>
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-2xl shadow-2xl p-12 max-w-3xl w-full space-y-8`}>
                                <div className="flex justify-end mb-4">
                                    <select value={language} onChange={(e) => setLanguage(e.target.value)} className={`px-4 py-2 rounded-lg border font-semibold ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'bg-gray-100 border-gray-300'}`}>
                                        <option value="es">üá™üá∏ Espa√±ol</option>
                                        <option value="en">üá¨üáß English</option>
                                    </select>
                                </div>

                                <div className="text-center">
                                    <h1 className="text-5xl font-light gradient-text mb-4">‚ú® Lumera</h1>
                                    <p className="text-2xl font-light text-gray-700 dark:text-gray-300 mb-6">{language === 'es' ? 'Tu Compa√±era Personalizada' : 'Your Personalized Companion'}</p>
                                    <p className="text-lg text-gray-600 dark:text-gray-400 leading-relaxed mb-8">
                                        {language === 'es' 
                                            ? 'Entre los 40 y 55 a√±os, tu cuerpo vive una transformaci√≥n profunda. Aqu√≠, cada cambio es natural, cada s√≠ntoma v√°lido. Tu transformaci√≥n es un acto de gracia y fortaleza que merece ser acompa√±ado.'
                                            : 'Between 40 and 55, your body undergoes a profound transformation. Here, every change is natural, every symptom is valid. Your transformation is an act of grace and strength that deserves to be supported.'}
                                    </p>
                                </div>

                                <div className={`${darkMode ? 'bg-gray-700' : 'bg-purple-50'} rounded-xl p-8 space-y-4 border-l-4 border-purple-600`}>
                                    <h3 className="font-bold text-lg">{language === 'es' ? '‚ú® ¬øQu√© Hace Especial a Lumera?' : '‚ú® What Makes Lumera Special?'}</h3>
                                    <div className="space-y-3 text-sm">
                                        <p>‚úÖ {language === 'es' ? 'Men√∫s 7 d√≠as personalizados (4 comidas/d√≠a) - Tu nutrici√≥n √∫nica' : 'Personalized 7-day menus (4 meals/day) - Your unique nutrition'}</p>
                                        <p>‚úÖ {language === 'es' ? 'Ejercicios seg√∫n TU objetivo (Fuerza, Peso, Hormonal) con rutina semanal' : 'Exercises for YOUR goal (Strength, Weight, Hormonal) with weekly routine'}</p>
                                        <p>‚úÖ {language === 'es' ? 'Coach permanente individual - No est√°s sola' : 'Personal permanent coach - You\'re not alone'}</p>
                                        <p>‚úÖ {language === 'es' ? 'Privacidad total - Todo en tu dispositivo, sin servidores' : 'Complete privacy - Everything on your device, no servers'}</p>
                                        <p>‚úÖ {language === 'es' ? 'Informaci√≥n con ciencia real - Mitos desmentidos con n√∫meros' : 'Science-backed information - Myths debunked with real data'}</p>
                                        <p>‚úÖ {language === 'es' ? 'Gr√°ficos de tendencia - Visualiza tu evoluci√≥n' : 'Trend graphs - Visualize your progress'}</p>
                                    </div>
                                </div>

                                <button onClick={() => setQuizStep(2)} className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-4 rounded-xl font-semibold hover:shadow-lg text-lg">
                                    {language === 'es' ? 'Siguiente' : 'Next'} ‚Üí
                                </button>
                            </div>
                        </div>
                    );
                }

                if (quizStep === 2) {
                    return (
                        <div className={`min-h-screen ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-purple-100 to-pink-100'} flex items-center justify-center p-4`}>
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-2xl shadow-2xl p-12 max-w-2xl w-full`}>
                                <h2 className="text-3xl font-light gradient-text mb-8">{language === 'es' ? 'Tu Perfil' : 'Your Profile'}</h2>
                                
                                <div className="space-y-4 mb-8">
                                    <input type="text" placeholder={language === 'es' ? 'Tu nombre' : 'Your name'} 
                                        value={formData.profileName}
                                        onChange={(e) => setFormData({...formData, profileName: e.target.value})}
                                        className={`w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : ''}`}/>
                                    
                                    <div className="grid grid-cols-3 gap-4">
                                        <input type="number" placeholder={language === 'es' ? 'Edad' : 'Age'} 
                                            value={formData.age}
                                            onChange={(e) => setFormData({...formData, age: e.target.value})}
                                            className={`px-4 py-3 border rounded-lg ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300'}`}/>
                                        <input type="number" placeholder={language === 'es' ? 'Altura (cm)' : 'Height (cm)'} 
                                            value={formData.height}
                                            onChange={(e) => setFormData({...formData, height: e.target.value})}
                                            className={`px-4 py-3 border rounded-lg ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300'}`}/>
                                        <input type="number" placeholder={language === 'es' ? 'Peso (kg)' : 'Weight (kg)'} 
                                            value={formData.weight}
                                            onChange={(e) => setFormData({...formData, weight: e.target.value})}
                                            className={`px-4 py-3 border rounded-lg ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300'}`}/>
                                    </div>
                                </div>

                                <button onClick={() => setQuizStep(3)} className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg mb-4">
                                    {language === 'es' ? 'Siguiente' : 'Next'} ‚Üí
                                </button>
                            </div>
                        </div>
                    );
                }

                if (quizStep === 3) {
                    const conditions = language === 'es' 
                        ? ['Diabetes', 'Hipertensi√≥n', 'Sin gluten', 'Sin lactosa', 'Vegetariana', 'Vegana', 'Artritis', 'Ansiedad']
                        : ['Diabetes', 'Hypertension', 'Gluten-free', 'Lactose-free', 'Vegetarian', 'Vegan', 'Arthritis', 'Anxiety'];
                    
                    return (
                        <div className={`min-h-screen ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-purple-100 to-pink-100'} flex items-center justify-center p-4`}>
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-2xl shadow-2xl p-12 max-w-2xl w-full`}>
                                <h2 className="text-3xl font-light gradient-text mb-6">{language === 'es' ? 'Restricciones' : 'Restrictions'}</h2>
                                
                                <div className="grid grid-cols-2 gap-4 mb-8">
                                    {conditions.map((cond, idx) => (
                                        <label key={idx} className={`flex items-center p-4 border rounded-lg cursor-pointer transition ${
                                            formData.conditions.includes(cond)
                                                ? darkMode ? 'bg-purple-900 border-purple-600' : 'bg-purple-100 border-purple-600'
                                                : darkMode ? 'border-gray-600' : 'border-gray-300'
                                        }`}>
                                            <input type="checkbox" 
                                                checked={formData.conditions.includes(cond)}
                                                onChange={(e) => {
                                                    if (e.target.checked) {
                                                        setFormData({...formData, conditions: [...formData.conditions, cond]});
                                                    } else {
                                                        setFormData({...formData, conditions: formData.conditions.filter(c => c !== cond)});
                                                    }
                                                }}
                                                className="mr-3 w-4 h-4"/>
                                            <span>{cond}</span>
                                        </label>
                                    ))}
                                </div>

                                <button onClick={() => setQuizStep(4)} className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg">
                                    {language === 'es' ? 'Siguiente' : 'Next'} ‚Üí
                                </button>
                            </div>
                        </div>
                    );
                }

                if (quizStep === 4) {
                    const activityLevels = [
                        { value: 'sedentary', label: t[language].activitySedentary, desc: t[language].activitySedentaryDesc, multiplier: 1.2 },
                        { value: 'lightly_active', label: t[language].activityLight, desc: t[language].activityLightDesc, multiplier: 1.375 },
                        { value: 'moderately_active', label: t[language].activityModerate, desc: t[language].activityModerateDesc, multiplier: 1.55 },
                        { value: 'very_active', label: t[language].activityVery, desc: t[language].activityVeryDesc, multiplier: 1.725 },
                        { value: 'extremely_active', label: t[language].activityExtreme, desc: t[language].activityExtremeDesc, multiplier: 1.9 }
                    ];

                    return (
                        <div className={`min-h-screen ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-purple-100 to-pink-100'} flex items-center justify-center p-4`}>
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-2xl shadow-2xl p-12 max-w-2xl w-full`}>
                                <h2 className="text-3xl font-light gradient-text mb-4">{t[language].activityQuestion}</h2>
                                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-8`}>
                                    {language === 'es' 
                                        ? 'Esto nos ayuda a calcular tu gasto energ√©tico diario (TDEE) de forma precisa'
                                        : 'This helps us calculate your daily energy expenditure (TDEE) accurately'}
                                </p>
                                
                                <div className="space-y-3 mb-8">
                                    {activityLevels.map((level) => (
                                        <label key={level.value} className={`flex items-start p-4 border-2 rounded-xl cursor-pointer transition ${
                                            formData.activityLevel === level.value
                                                ? darkMode ? 'bg-purple-900 border-purple-600' : 'bg-purple-100 border-purple-600'
                                                : darkMode ? 'border-gray-600' : 'border-gray-300'
                                        }`}>
                                            <input type="radio" name="activity" value={level.value}
                                                checked={formData.activityLevel === level.value}
                                                onChange={(e) => setFormData({...formData, activityLevel: e.target.value, activityMultiplier: level.multiplier})}
                                                className="mr-4 w-5 h-5 mt-1"/>
                                            <div>
                                                <div className="font-semibold text-lg">{level.label}</div>
                                                <div className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>{level.desc}</div>
                                            </div>
                                        </label>
                                    ))}
                                </div>

                                <button onClick={() => setQuizStep(5)} 
                                    disabled={!formData.activityLevel}
                                    className={`w-full py-3 rounded-lg font-semibold ${
                                        formData.activityLevel 
                                            ? 'bg-gradient-to-r from-purple-600 to-pink-600 text-white hover:shadow-lg' 
                                            : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                    }`}>
                                    {language === 'es' ? 'Siguiente' : 'Next'} ‚Üí
                                </button>
                            </div>
                        </div>
                    );
                }

                if (quizStep === 5) {
                    const goals = [
                        { value: 'strength', label: language === 'es' ? 'Ganar Fuerza' : 'Build Strength' },
                        { value: 'weightLoss', label: language === 'es' ? 'Perder Peso' : 'Lose Weight' },
                        { value: 'hormonal', label: language === 'es' ? 'Equilibrio Hormonal' : 'Hormonal Balance' }
                    ];

                    return (
                        <div className={`min-h-screen ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-purple-100 to-pink-100'} flex items-center justify-center p-4`}>
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-2xl shadow-2xl p-12 max-w-2xl w-full`}>
                                <h2 className="text-3xl font-light gradient-text mb-8">{language === 'es' ? '¬øCu√°l es tu objetivo?' : 'What\'s Your Goal?'}</h2>
                                
                                <div className="space-y-4 mb-8">
                                    {goals.map((goal) => (
                                        <label key={goal.value} className={`flex items-center p-6 border-2 rounded-xl cursor-pointer transition ${
                                            exerciseGoal === goal.value
                                                ? darkMode ? 'bg-purple-900 border-purple-600' : 'bg-purple-100 border-purple-600'
                                                : darkMode ? 'border-gray-600' : 'border-gray-300'
                                        }`}>
                                            <input type="radio" name="goal" value={goal.value}
                                                checked={exerciseGoal === goal.value}
                                                onChange={(e) => setExerciseGoal(e.target.value)}
                                                className="mr-4 w-5 h-5"/>
                                            <span className="font-semibold text-lg">{goal.label}</span>
                                        </label>
                                    ))}
                                </div>

                                <button onClick={() => setQuizStep(6)} className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg">
                                    {language === 'es' ? 'Siguiente' : 'Next'} ‚Üí
                                </button>
                            </div>
                        </div>
                    );
                }

                if (quizStep === 6) {
                    const regions = [
                        { value: 'LATAM', label: language === 'es' ? 'üåé Latinoam√©rica' : 'üåé Latin America' },
                        { value: 'EMEA', label: language === 'es' ? 'üåç Europa / √Åfrica' : 'üåç Europe / Africa' },
                        { value: 'USA', label: language === 'es' ? 'üåé USA / Canad√°' : 'üåé USA / Canada' }
                    ];

                    return (
                        <div className={`min-h-screen ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-purple-100 to-pink-100'} flex items-center justify-center p-4`}>
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-2xl shadow-2xl p-12 max-w-2xl w-full`}>
                                <h2 className="text-3xl font-light gradient-text mb-4">{language === 'es' ? '¬øD√≥nde est√°s?' : 'Where are you?'}</h2>
                                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-8`}>
                                    {language === 'es' 
                                        ? 'Esto nos ayuda a personalizar ingredientes locales seg√∫n tu regi√≥n'
                                        : 'This helps us personalize local ingredients for your region'}
                                </p>
                                
                                <div className="space-y-4 mb-8">
                                    {regions.map((region) => (
                                        <label key={region.value} className={`flex items-center p-6 border-2 rounded-xl cursor-pointer transition ${
                                            userRegion === region.value
                                                ? darkMode ? 'bg-purple-900 border-purple-600' : 'bg-purple-100 border-purple-600'
                                                : darkMode ? 'border-gray-600' : 'border-gray-300'
                                        }`}>
                                            <input type="radio" name="region" value={region.value}
                                                checked={userRegion === region.value}
                                                onChange={(e) => setUserRegion(e.target.value)}
                                                className="mr-4 w-5 h-5"/>
                                            <span className="font-semibold text-lg">{region.label}</span>
                                        </label>
                                    ))}
                                </div>

                                <button onClick={async () => {
                                    if (!formData.profileName || !formData.age || !formData.height || !formData.weight) {
                                        alert(language === 'es' ? 'Completa todos los campos' : 'Complete all fields');
                                        return;
                                    }
                                    
                                    if (!session) {
                                        alert(language === 'es' ? 'Error: No hay sesi√≥n activa. Por favor recarga la p√°gina.' : 'Error: No active session. Please reload the page.');
                                        return;
                                    }
                                    
                                    const bmi = (parseFloat(formData.weight) / ((parseFloat(formData.height) / 100) ** 2)).toFixed(1);
                                    const bmr = 10 * parseFloat(formData.weight) + 6.25 * parseFloat(formData.height) - 5 * parseInt(formData.age) + 161;
                                    const tdee = Math.round(bmr * formData.activityMultiplier);
                                    
                                    // SIEMPRE guardar en Supabase
                                    const { data, error } = await supabase.from('user_profiles').upsert({
                                        user_id: session.user.id,
                                        profile_name: formData.profileName,
                                        age: parseInt(formData.age),
                                        height: parseFloat(formData.height),
                                        weight: parseFloat(formData.weight),
                                        conditions: formData.conditions,
                                        activity_level: formData.activityLevel,
                                        activity_multiplier: formData.activityMultiplier,
                                        bmi: parseFloat(bmi),
                                        bmr: parseFloat(bmr),
                                        tdee: parseInt(tdee),
                                        exercise_goal: exerciseGoal,
                                        region: userRegion,
                                        subscription_status: 'free',
                                        created_at: new Date().toISOString(),
                                        updated_at: new Date().toISOString()
                                    }).select().single();
                                    
                                    if (error) {
                                        console.error('Error guardando perfil:', error);
                                        alert(language === 'es' ? 'Error al guardar perfil. Intenta de nuevo.' : 'Error saving profile. Try again.');
                                        return;
                                    }
                                    
                                    if (data) {
                                        console.log('Perfil guardado exitosamente:', data);
                                        setCurrentUser(data);
                                        localStorage.setItem('lumeraUser', JSON.stringify(data));
                                        setShowQuiz(false);
                                        setCurrentPage('home');
                                    }
                                }} className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg">
                                    {language === 'es' ? '¬°Comenzar!' : 'Let\'s Go!'} ‚ú®
                                </button>
                            </div>
                        </div>
                    );
                }
            };

            // HOME
            const renderHome = () => {
                if (!currentUser) return null;
                return (
                    <div className="pb-32 space-y-6" key={language}>
                        {/* BIENVENIDA */}
                        <div className="bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-2xl p-6 shadow-lg">
                            <h1 className="text-3xl font-light mb-2">{language === 'es' ? `¬°Hola, ${currentUser.profileName}! üíú` : `Hi, ${currentUser.profileName}! üíú`}</h1>
                            <p className="text-base opacity-90">
                                {language === 'es' 
                                    ? 'Respira. Ya est√°s aqu√≠. Eso ya cuenta.'
                                    : 'Breathe. You\'re here. That already counts.'}
                            </p>
                        </div>

                        {/* MENSAJE POSITIVO PERSONALIZADO */}
                        <div className={`${darkMode ? 'bg-purple-900' : 'bg-purple-50'} rounded-xl shadow p-5 border-l-4 border-purple-600`}>
                            <p className={`text-sm ${darkMode ? 'text-purple-200' : 'text-purple-900'} font-medium`}>
                                {language === 'es'
                                    ? `Hoy es un buen d√≠a para escuchar a tu cuerpo, ${currentUser.profileName}. No tienes que hacerlo perfecto. Solo empezar.`
                                    : `Today is a good day to listen to your body, ${currentUser.profileName}. You don't have to do it perfectly. Just start.`}
                            </p>
                        </div>

                        {/* CTA REGISTRAR S√çNTOMAS */}
                        <div className={`${darkMode ? 'bg-indigo-900' : 'bg-gradient-to-r from-indigo-50 to-purple-50'} rounded-xl shadow-lg p-6 border-2 border-indigo-400`}>
                            <div className="flex items-start gap-4">
                                <div className="text-4xl">üìù</div>
                                <div className="flex-1">
                                    <h3 className="text-xl font-semibold gradient-text mb-2">
                                        {language === 'es' ? 'Empieza aqu√≠' : 'Start here'}
                                    </h3>
                                    <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-4`}>
                                        {language === 'es'
                                            ? 'Cu√©ntale a Lumera c√≥mo te sientes hoy. 2 minutos que marcan la diferencia.'
                                            : 'Tell Lumera how you feel today. 2 minutes that make a difference.'}
                                    </p>
                                    <button 
                                        onClick={() => setCurrentPage('symptoms')}
                                        className="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-lg font-semibold hover:shadow-lg transition"
                                    >
                                        {language === 'es' ? 'Registrar c√≥mo me siento' : 'Log how I feel'}
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* FRASE ANCLA */}
                        <div className={`${darkMode ? 'bg-indigo-900' : 'bg-indigo-50'} rounded-xl shadow-lg p-6 border-l-4 border-indigo-600`}>
                            <h2 className="text-2xl font-semibold gradient-text mb-3">
                                {language === 'es' ? 'üå∏ Tu cuerpo est√° hablando' : 'üå∏ Your body is speaking'}
                            </h2>
                            <p className={`${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-3`}>
                                {language === 'es'
                                    ? 'Los sudores nocturnos, el insomnio, los cambios de √°nimo... No son se√±ales de alarma. Son tu cuerpo adapt√°ndose.'
                                    : 'Night sweats, insomnia, mood changes... They\'re not alarm signals. It\'s your body adapting.'}
                            </p>
                            <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} italic`}>
                                {language === 'es'
                                    ? 'Esta etapa tiene su propio lenguaje. Lumera te ayuda a traducirlo.'
                                    : 'This stage has its own language. Lumera helps you translate it.'}
                            </p>
                        </div>

                        {/* TUS DATOS */}
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl p-4 shadow`}>
                                <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1 font-semibold`}>{language === 'es' ? 'IMC' : 'BMI'}</p>
                                <p className="text-2xl font-bold gradient-text">{currentUser.bmi}</p>
                            </div>
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl p-4 shadow`}>
                                <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1 font-semibold`}>TDEE</p>
                                <p className="text-2xl font-bold text-pink-600">{currentUser.tdee}</p>
                            </div>
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl p-4 shadow`}>
                                <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1 font-semibold`}>{language === 'es' ? 'Edad' : 'Age'}</p>
                                <p className="text-2xl font-bold text-blue-600">{currentUser.age}</p>
                            </div>
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl p-4 shadow`}>
                                <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1 font-semibold`}>{language === 'es' ? 'Objetivo' : 'Goal'}</p>
                                <p className="text-sm font-bold text-green-600">{currentUser.exerciseGoal === 'strength' ? t[language].strength : currentUser.exerciseGoal === 'weightLoss' ? t[language].weightLoss : t[language].hormonal}</p>
                            </div>
                        </div>

                        {/* TUTORIAL DESPLEGABLE */}
                        <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow p-6`}>
                            <button 
                                onClick={() => setShowTutorial(!showTutorial)}
                                className="w-full flex items-center justify-between text-left"
                            >
                                <h3 className="text-xl font-semibold gradient-text">
                                    {language === 'es' ? 'üìñ C√≥mo usar Lumera' : 'üìñ How to use Lumera'}
                                </h3>
                                <span className="text-2xl">{showTutorial ? '‚àí' : '+'}</span>
                            </button>
                            
                            {showTutorial && (
                                <div className="mt-6 space-y-4">
                                    <div className="flex gap-3">
                                        <div className="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center text-white font-bold">1</div>
                                        <div>
                                            <h4 className="font-bold mb-1">{language === 'es' ? 'ü•ó Revisa tu men√∫' : 'ü•ó Check your menu'}</h4>
                                            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>
                                                {language === 'es' 
                                                    ? 'Cada semana tienes 4 comidas diarias adaptadas a tus restricciones y regi√≥n.'
                                                    : 'Each week you get 4 daily meals adapted to your restrictions and region.'}
                                            </p>
                                        </div>
                                    </div>

                                    <div className="flex gap-3">
                                        <div className="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center text-white font-bold">2</div>
                                        <div>
                                            <h4 className="font-bold mb-1">{language === 'es' ? 'üìù Registra c√≥mo te sientes' : 'üìù Log how you feel'}</h4>
                                            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>
                                                {language === 'es' 
                                                    ? '2 minutos diarios. Ver√°s patrones en gr√°ficos que puedes compartir con tu m√©dico.'
                                                    : '2 minutes daily. You\'ll see patterns in graphs you can share with your doctor.'}
                                            </p>
                                        </div>
                                    </div>

                                    <div className="flex gap-3">
                                        <div className="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center text-white font-bold">3</div>
                                        <div>
                                            <h4 className="font-bold mb-1">{language === 'es' ? 'üí™ Sigue tus ejercicios' : 'üí™ Follow your exercises'}</h4>
                                            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>
                                                {language === 'es' 
                                                    ? 'Rutina personalizada seg√∫n tu objetivo (Fuerza, Peso, Equilibrio Hormonal).'
                                                    : 'Personalized routine based on your goal (Strength, Weight Loss, Hormonal Balance).'}
                                            </p>
                                        </div>
                                    </div>

                                    <div className="flex gap-3">
                                        <div className="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center text-white font-bold">4</div>
                                        <div>
                                            <h4 className="font-bold mb-1">{language === 'es' ? 'üíú Usa los recursos' : 'üíú Use the resources'}</h4>
                                            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>
                                                {language === 'es' 
                                                    ? 'Mitos desmontados con ciencia y consejos pr√°cticos en las pesta√±as de abajo.'
                                                    : 'Myths debunked with science and practical advice in the tabs below.'}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* PARA QUI√âN NO ES LUMERA */}
                        <div className={`${darkMode ? 'bg-gray-800' : 'bg-yellow-50'} rounded-xl shadow p-6 border-l-4 border-yellow-600`}>
                            <h3 className="font-bold text-lg mb-3">
                                ‚ö†Ô∏è {language === 'es' ? 'Lumera no es para ti si buscas:' : 'Lumera is not for you if you seek:'}
                            </h3>
                            <ul className={`space-y-2 text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                <li>‚Ä¢ {language === 'es' ? 'Dietas milagro' : 'Miracle diets'}</li>
                                <li>‚Ä¢ {language === 'es' ? 'Resultados en 7 d√≠as' : 'Results in 7 days'}</li>
                                <li>‚Ä¢ {language === 'es' ? 'Soluciones m√°gicas' : 'Magic solutions'}</li>
                            </ul>
                            <p className={`mt-3 text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-900'}`}>
                                {language === 'es'
                                    ? 'Lumera es para mujeres que quieren entenderse, no arreglarse r√°pido.'
                                    : 'Lumera is for women who want to understand themselves, not fix themselves quickly.'}
                            </p>
                        </div>
                    </div>
                );
            };

            // NUTRICI√ìN
            const renderNutrition = () => {
                const daysOrder = ['lunes', 'martes', 'miercoles', 'jueves', 'viernes', 'sabado', 'domingo'];
                const daysLabels = language === 'es' ? ['Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado', 'Domingo'] : ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
                const mealLabels = language === 'es' ? { Desayuno: 'Desayuno', Almuerzo: 'Almuerzo', Cena: 'Cena', Snack: 'Snack' } : { Desayuno: 'Breakfast', Almuerzo: 'Lunch', Cena: 'Dinner', Snack: 'Snack' };
                const menus = getWeekMenus();
                const premium = isPremium();

                return (
                    <div className="pb-32 space-y-8" key={`nutrition-${language}`}>
                        <h2 className="text-3xl font-light gradient-text">{t[language].nutrition}</h2>

                        {daysOrder.map((day, dayIdx) => {
                            const recipes = menus[language === 'es' ? 'es' : 'en'][day] || [];
                            const isLocked = dayIdx > 0 && !premium; // Solo d√≠a 1 gratis
                            
                            return (
                                <div key={day} className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-2xl shadow-lg overflow-hidden ${isLocked ? 'relative' : ''}`}>
                                    <div className="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6">
                                        <h3 className="text-2xl font-semibold">üìÖ {daysLabels[dayIdx]} {isLocked && 'üîí'}</h3>
                                    </div>

                                    {isLocked ? (
                                        <div className="p-12 text-center">
                                            <div className="mb-6">
                                                <div className="inline-block p-6 bg-gradient-to-br from-purple-100 to-pink-100 rounded-full mb-4">
                                                    <svg className="w-16 h-16 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                                    </svg>
                                                </div>
                                            </div>
                                            <h3 className="text-2xl font-semibold gradient-text mb-3">
                                                {language === 'es' ? 'Acomp√°√±ate toda la semana' : 'Get support all week'}
                                            </h3>
                                            <p className={`text-lg ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-6 max-w-md mx-auto`}>
                                                {language === 'es'
                                                    ? 'Con Lumera Premium, tienes men√∫s completos para los 7 d√≠as. Cada comida pensada para ti.'
                                                    : 'With Lumera Premium, you get complete menus for all 7 days. Each meal designed for you.'}
                                            </p>
                                            <button 
                                                onClick={() => setCurrentPage('home')}
                                                className="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:shadow-lg"
                                            >
                                                üíú {language === 'es' ? 'Ver Premium' : 'See Premium'}
                                            </button>
                                        </div>
                                    ) : (
                                        <div className="p-6 space-y-6">
                                            {recipes.map((recipe, idx) => (
                                                <div key={idx} className={`${darkMode ? 'bg-gray-700' : 'bg-gray-50'} rounded-xl p-6 border-l-4 border-purple-600`}>
                                                    <div className="flex justify-between items-start mb-4">
                                                        <div>
                                                            <h4 className="text-xl font-semibold">{recipe.name}</h4>
                                                            <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>{mealLabels[recipe.meal] || recipe.meal}</p>
                                                        </div>
                                                        <span className={`${darkMode ? 'bg-gray-600' : 'bg-purple-100'} text-purple-700 px-3 py-1 rounded-lg text-sm font-semibold`}>{recipe.calories} cal</span>
                                                    </div>

                                                    <div className="grid md:grid-cols-2 gap-6 mb-4">
                                                        <div>
                                                            <h5 className="font-semibold mb-3">‚úì {t[language].ingredients}</h5>
                                                            <div className="space-y-2 text-sm">
                                                                {recipe.ingredients.map((ing, i) => (
                                                                    <div key={i}>
                                                                        <p className="font-medium">{ing.name}: <span className="text-purple-600">{ing.qty}{ing.unit}</span></p>
                                                                        <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>{ing.why}</p>
                                                                    </div>
                                                                ))}
                                                            </div>
                                                        </div>

                                                        <div>
                                                            <h5 className="font-semibold mb-3">üë®‚Äçüç≥ {t[language].preparation}</h5>
                                                            <ol className="space-y-1 text-sm">
                                                                {recipe.steps.map((step, i) => (
                                                                    <li key={i}>‚úì {step}</li>
                                                                ))}
                                                            </ol>
                                                        </div>
                                                    </div>

                                                    <div className={`p-3 rounded-lg ${darkMode ? 'bg-gray-600' : 'bg-blue-50'} border-l-2 border-blue-500`}>
                                                        <p className={`text-sm font-semibold ${darkMode ? 'text-blue-300' : 'text-blue-900'}`}>üí° {t[language].why}: {recipe.why}</p>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            );
                        })}
                    </div>
                );
            };

            // EJERCICIOS
            const renderExercise = () => {
                const exercises = getExercises();
                const objectives = { strength: language === 'es' ? 'üí™ Ganar Fuerza' : 'üí™ Build Strength', weightLoss: language === 'es' ? '‚ö° Perder Peso' : '‚ö° Lose Weight', hormonal: language === 'es' ? 'üßò Equilibrio Hormonal' : 'üßò Hormonal Balance' };
                const premium = isPremium();
                const previewCount = 3; // Solo 3 ejercicios gratis

                return (
                    <div className="pb-32 space-y-8" key={`exercise-${language}`}>
                        <div>
                            <h2 className="text-3xl font-light gradient-text">{t[language].exercise}</h2>
                            <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>{objectives[exerciseGoal]}</p>
                        </div>

                        <div className="flex gap-4 overflow-x-auto pb-4">
                            {['strength', 'weightLoss', 'hormonal'].map((goal) => (
                                <button key={goal} onClick={() => setExerciseGoal(goal)} className={`px-6 py-3 rounded-lg font-semibold whitespace-nowrap transition ${exerciseGoal === goal ? 'bg-purple-600 text-white' : darkMode ? 'bg-gray-800 text-gray-300' : 'bg-gray-200 text-gray-700'}`}>
                                    {goal === 'strength' ? t[language].strength : goal === 'weightLoss' ? t[language].weightLoss : t[language].hormonal}
                                </button>
                            ))}
                        </div>

                        <div className={`${darkMode ? 'bg-gray-800' : 'bg-blue-50'} rounded-xl p-6 border-l-4 border-blue-600 mb-6`}>
                            <h3 className={`font-bold mb-3 ${darkMode ? 'text-blue-300' : 'text-blue-900'}`}>üìÖ {language === 'es' ? 'Tu Rutina Semanal' : 'Your Weekly Routine'}</h3>
                            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                {language === 'es' 
                                    ? 'Esta rutina est√° dise√±ada para tu objetivo. Cada ejercicio tiene ciencia detr√°s.'
                                    : 'This routine is designed for your goal. Each exercise is science-backed.'}
                            </p>
                        </div>

                        <div className="space-y-6">
                            {exercises.slice(0, premium ? exercises.length : previewCount).map((ex, idx) => (
                                <div key={idx} className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg overflow-hidden`}>
                                    <div className="bg-gradient-to-r from-green-500 to-emerald-600 text-white p-6">
                                        <div className="flex justify-between items-start">
                                            <div>
                                                <h3 className="text-2xl font-semibold mb-2">{ex.name}</h3>
                                                <div className="flex gap-4 text-sm flex-wrap">
                                                    <span>‚è± {ex.duration}</span>
                                                    <span>üí™ {ex.difficulty}</span>
                                                    <span>üìÖ {ex.freq}</span>
                                                    <span className="bg-white bg-opacity-20 px-3 py-1 rounded-lg">üìÜ {ex.day}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="p-6 space-y-4">
                                        <div className={`${darkMode ? 'bg-gray-700' : 'bg-yellow-50'} p-4 rounded-lg border-l-4 border-yellow-500`}>
                                            <p className={`text-sm font-semibold mb-2 ${darkMode ? 'text-yellow-300' : 'text-yellow-900'}`}>üí° {t[language].why}:</p>
                                            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>{ex.why}</p>
                                        </div>

                                        <div className={`${darkMode ? 'bg-gray-700' : 'bg-blue-50'} p-4 rounded-lg border-l-4 border-blue-600`}>
                                            <p className={`text-sm font-semibold mb-2 ${darkMode ? 'text-blue-300' : 'text-blue-900'}`}>üî¨ {language === 'es' ? 'Base Cient√≠fica' : 'Science'}:</p>
                                            <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>{ex.science}</p>
                                        </div>
                                    </div>
                                </div>
                            ))}

                            {!premium && exercises.length > previewCount && (
                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-2xl shadow-lg p-12 text-center`}>
                                    <div className="mb-6">
                                        <div className="inline-block p-6 bg-gradient-to-br from-purple-100 to-pink-100 rounded-full mb-4">
                                            <svg className="w-16 h-16 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                            </svg>
                                        </div>
                                    </div>
                                    <h3 className="text-2xl font-semibold gradient-text mb-3">
                                        {language === 'es' ? 'Rutina completa con Premium' : 'Complete routine with Premium'}
                                    </h3>
                                    <p className={`text-lg ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-6 max-w-md mx-auto`}>
                                        {language === 'es'
                                            ? `Tienes ${exercises.length - previewCount} ejercicios m√°s esper√°ndote. Cada uno dise√±ado para tu objetivo.`
                                            : `You have ${exercises.length - previewCount} more exercises waiting. Each designed for your goal.`}
                                    </p>
                                    <button 
                                        onClick={() => setCurrentPage('home')}
                                        className="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:shadow-lg"
                                    >
                                        üíú {language === 'es' ? 'Ver Premium' : 'See Premium'}
                                    </button>
                                </div>
                            )}
                        </div>

                        <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                            <h3 className="font-bold text-lg mb-4">üíú {language === 'es' ? 'Consejos para √âxito' : 'Tips for Success'}</h3>
                            <ul className="space-y-3 text-sm">
                                <li>‚úÖ {language === 'es' ? 'Sigue tu rutina 3-4 meses antes de cambiar' : 'Follow your routine for 3-4 months before changing'}</li>
                                <li>‚úÖ {language === 'es' ? 'Escucha tu cuerpo - Descansa si necesitas' : 'Listen to your body - Rest if needed'}</li>
                                <li>‚úÖ {language === 'es' ? 'Calienta antes y estira despu√©s' : 'Warm up before, stretch after'}</li>
                                <li>‚úÖ {language === 'es' ? 'Consistencia > intensidad' : 'Consistency > intensity'}</li>
                            </ul>
                        </div>
                    </div>
                );
            };

            // S√çNTOMAS
            const renderSymptoms = () => {
                return (
                    <div className="pb-32 space-y-8" key={`symptoms-${language}`}>
                        <h2 className="text-3xl font-light gradient-text">{t[language].symptoms}</h2>
                        
                        <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6 space-y-6`}>
                            <h3 className="font-semibold text-lg">{language === 'es' ? 'Registra tu d√≠a' : 'Track your day'}</h3>
                            
                            <div className="space-y-4">
                                {[
                                    { key: 'sleep', label: language === 'es' ? 'Calidad del sue√±o' : 'Sleep quality', emoji: 'üò¥' },
                                    { key: 'energy', label: language === 'es' ? 'Nivel de energ√≠a' : 'Energy level', emoji: '‚ö°' },
                                    { key: 'mood', label: language === 'es' ? '√Ånimo' : 'Mood', emoji: 'üòä' },
                                    { key: 'hotFlashes', label: language === 'es' ? 'Sofocos' : 'Hot flashes', emoji: 'üî•' },
                                    { key: 'anxiety', label: language === 'es' ? 'Ansiedad' : 'Anxiety', emoji: 'üò∞' }
                                ].map((item) => (
                                    <div key={item.key}>
                                        <div className="flex justify-between mb-2">
                                            <label className="text-sm font-semibold">{item.emoji} {item.label}</label>
                                            <span className="text-purple-600 font-bold">{symptomForm[item.key]}/10</span>
                                        </div>
                                        <input type="range" min="0" max="10" value={symptomForm[item.key]} onChange={(e) => setSymptomForm({...symptomForm, [item.key]: parseInt(e.target.value)})} className="w-full accent-purple-600"/>
                                    </div>
                                ))}

                                <div>
                                    <label className="block text-sm font-semibold mb-2">{language === 'es' ? 'Fecha' : 'Date'}</label>
                                    <input type="date" value={symptomForm.date} onChange={(e) => setSymptomForm({...symptomForm, date: e.target.value})} className={`w-full px-4 py-2 border rounded-lg ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300'}`}/>
                                </div>
                            </div>

                            <button onClick={() => {
                                setSymptoms([...symptoms, symptomForm]);
                                setSymptomForm({ sleep: 5, energy: 5, mood: 5, hotFlashes: 0, anxiety: 5, date: new Date().toISOString().split('T')[0] });
                                // Mostrar notificaci√≥n personalizada
                                const notification = document.createElement('div');
                                notification.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-4 rounded-xl shadow-2xl z-50 max-w-md';
                                notification.innerHTML = `
                                    <div class="flex items-start gap-3">
                                        <div class="text-3xl">üíú</div>
                                        <div>
                                            <p class="font-bold mb-1">${language === 'es' ? '¬°S√≠ntoma registrado!' : 'Symptom recorded!'}</p>
                                            <p class="text-sm opacity-90">${language === 'es' ? 'Gracias. Esto me ayuda a acompa√±arte mejor. Tu men√∫ te est√° esperando en ü•ó Nutrici√≥n' : 'Thank you. This helps me support you better. Your menu is waiting in ü•ó Nutrition'}</p>
                                        </div>
                                    </div>
                                `;
                                document.body.appendChild(notification);
                                setTimeout(() => notification.remove(), 5000);
                            }} className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg">
                                {t[language].addRecord}
                            </button>
                        </div>

                        {symptoms.length > 0 && (
                            <>
                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                    <h3 className="font-semibold text-lg mb-4">üìà {language === 'es' ? 'Tendencia de Sue√±o' : 'Sleep Trend'}</h3>
                                    <canvas ref={chartRefSleep} style={{maxHeight: '300px'}}></canvas>
                                </div>

                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                    <h3 className="font-semibold text-lg mb-4">üìà {language === 'es' ? 'Tendencia de Energ√≠a' : 'Energy Trend'}</h3>
                                    <canvas ref={chartRefEnergy} style={{maxHeight: '300px'}}></canvas>
                                </div>

                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                    <h3 className="font-semibold text-lg mb-4">üìà {language === 'es' ? 'Tendencia de √Ånimo' : 'Mood Trend'}</h3>
                                    <canvas ref={chartRefMood} style={{maxHeight: '300px'}}></canvas>
                                </div>

                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                    <h3 className="font-semibold text-lg mb-4">üìà {language === 'es' ? 'Tendencia de Sofocos' : 'Hot Flashes Trend'}</h3>
                                    <canvas ref={chartRefHotFlashes} style={{maxHeight: '300px'}}></canvas>
                                </div>

                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="font-semibold text-lg">üìä {language === 'es' ? 'Resumen General' : 'Overall Summary'}</h3>
                                        <button onClick={async () => {
                                            const { jsPDF } = window.jspdf;
                                            const doc = new jsPDF();
                                            
                                            doc.setFontSize(20);
                                            doc.text('Lumera - Reporte de S√≠ntomas', 20, 20);
                                            
                                            doc.setFontSize(12);
                                            doc.text(`${language === 'es' ? 'Usuaria' : 'User'}: ${currentUser.profileName}`, 20, 40);
                                            doc.text(`${language === 'es' ? 'Fecha' : 'Date'}: ${new Date().toLocaleDateString()}`, 20, 50);
                                            
                                            const avgSleep = (symptoms.reduce((a, s) => a + s.sleep, 0) / symptoms.length).toFixed(1);
                                            const avgEnergy = (symptoms.reduce((a, s) => a + s.energy, 0) / symptoms.length).toFixed(1);
                                            const avgMood = (symptoms.reduce((a, s) => a + s.mood, 0) / symptoms.length).toFixed(1);
                                            
                                            doc.setFontSize(14);
                                            doc.text(language === 'es' ? 'Promedios' : 'Averages', 20, 70);
                                            doc.setFontSize(11);
                                            doc.text(`${language === 'es' ? 'Sue√±o' : 'Sleep'}: ${avgSleep}/10`, 20, 85);
                                            doc.text(`${language === 'es' ? 'Energ√≠a' : 'Energy'}: ${avgEnergy}/10`, 20, 95);
                                            doc.text(`${language === 'es' ? '√Ånimo' : 'Mood'}: ${avgMood}/10`, 20, 105);
                                            
                                            doc.text(`${language === 'es' ? 'Total de registros' : 'Total records'}: ${symptoms.length}`, 20, 120);
                                            
                                            doc.save(`Lumera_Sintomas_${new Date().toISOString().split('T')[0]}.pdf`);
                                        }} className="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700">
                                            üì• {language === 'es' ? 'Descargar PDF' : 'Download PDF'}
                                        </button>
                                    </div>
                                    <div className="grid grid-cols-3 gap-4">
                                        <div className={`${darkMode ? 'bg-gray-700' : 'bg-blue-50'} p-4 rounded-lg`}>
                                            <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-2`}>{language === 'es' ? 'Promedio Sue√±o' : 'Avg Sleep'}</p>
                                            <p className="text-2xl font-bold text-blue-600">{(symptoms.reduce((a, s) => a + s.sleep, 0) / symptoms.length).toFixed(1)}/10</p>
                                        </div>
                                        <div className={`${darkMode ? 'bg-gray-700' : 'bg-pink-50'} p-4 rounded-lg`}>
                                            <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-2`}>{language === 'es' ? 'Promedio Energ√≠a' : 'Avg Energy'}</p>
                                            <p className="text-2xl font-bold text-pink-600">{(symptoms.reduce((a, s) => a + s.energy, 0) / symptoms.length).toFixed(1)}/10</p>
                                        </div>
                                        <div className={`${darkMode ? 'bg-gray-700' : 'bg-cyan-50'} p-4 rounded-lg`}>
                                            <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-2`}>{language === 'es' ? 'Promedio √Ånimo' : 'Avg Mood'}</p>
                                            <p className="text-2xl font-bold text-cyan-600">{(symptoms.reduce((a, s) => a + s.mood, 0) / symptoms.length).toFixed(1)}/10</p>
                                        </div>
                                    </div>
                                </div>
                            </>
                        )}
                    </div>
                );
            };

            // PER√çODO
            const renderPeriod = () => {
                return (
                    <div className="pb-32 space-y-8" key={`period-${language}`}>
                        <h2 className="text-3xl font-light gradient-text">{t[language].period}</h2>
                        
                        <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6 space-y-6`}>
                            <h3 className="font-semibold text-lg">{language === 'es' ? 'Registra tu per√≠odo' : 'Record your period'}</h3>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-semibold mb-2">{language === 'es' ? 'Intensidad (1-10)' : 'Intensity (1-10)'}</label>
                                    <input type="range" min="1" max="10" value={periodForm.intensity} onChange={(e) => setPeriodForm({...periodForm, intensity: parseInt(e.target.value)})} className="w-full accent-pink-600"/>
                                    <p className="text-sm text-gray-600 dark:text-gray-400 mt-1">{periodForm.intensity}/10</p>
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold mb-2">{language === 'es' ? 'Duraci√≥n (d√≠as)' : 'Duration (days)'}</label>
                                    <input type="range" min="1" max="10" value={periodForm.duration} onChange={(e) => setPeriodForm({...periodForm, duration: parseInt(e.target.value)})} className="w-full accent-pink-600"/>
                                    <p className="text-sm text-gray-600 dark:text-gray-400 mt-1">{periodForm.duration} {language === 'es' ? 'd√≠as' : 'days'}</p>
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold mb-2">{language === 'es' ? 'S√≠ntomas' : 'Symptoms'}</label>
                                    <input type="text" placeholder={language === 'es' ? 'Ej: c√≥licos, hinchaz√≥n' : 'E.g: cramps, bloating'} value={periodForm.symptoms} onChange={(e) => setPeriodForm({...periodForm, symptoms: e.target.value})} className={`w-full px-4 py-2 border rounded-lg ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300'}`}/>
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold mb-2">{language === 'es' ? 'Fecha' : 'Date'}</label>
                                    <input type="date" value={periodForm.date} onChange={(e) => setPeriodForm({...periodForm, date: e.target.value})} className={`w-full px-4 py-2 border rounded-lg ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300'}`}/>
                                </div>
                            </div>

                            <button onClick={() => {
                                setPeriodLog([...periodLog, periodForm]);
                                setPeriodForm({ intensity: 5, duration: 5, symptoms: '', date: new Date().toISOString().split('T')[0] });
                                alert(language === 'es' ? 'Per√≠odo registrado ‚úì' : 'Period recorded ‚úì');
                            }} className="w-full bg-gradient-to-r from-pink-600 to-rose-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg">
                                {t[language].addRecord}
                            </button>
                        </div>

                        {periodLog.length > 0 && (
                            <>
                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="font-semibold text-lg">üìà {language === 'es' ? 'Tendencia de Per√≠odo' : 'Period Trend'}</h3>
                                        <button onClick={() => {
                                            const { jsPDF } = window.jspdf;
                                            const doc = new jsPDF();
                                            
                                            doc.setFontSize(20);
                                            doc.text('Lumera - Reporte de Per√≠odo', 20, 20);
                                            
                                            doc.setFontSize(12);
                                            doc.text(`${language === 'es' ? 'Usuaria' : 'User'}: ${currentUser.profileName}`, 20, 40);
                                            doc.text(`${language === 'es' ? 'Fecha' : 'Date'}: ${new Date().toLocaleDateString()}`, 20, 50);
                                            
                                            doc.setFontSize(14);
                                            doc.text(language === 'es' ? 'Resumen de Registros' : 'Records Summary', 20, 70);
                                            doc.setFontSize(11);
                                            
                                            const avgIntensity = (periodLog.reduce((a, p) => a + p.intensity, 0) / periodLog.length).toFixed(1);
                                            const avgDuration = (periodLog.reduce((a, p) => a + p.duration, 0) / periodLog.length).toFixed(1);
                                            
                                            doc.text(`${language === 'es' ? 'Intensidad promedio' : 'Avg intensity'}: ${avgIntensity}/10`, 20, 85);
                                            doc.text(`${language === 'es' ? 'Duraci√≥n promedio' : 'Avg duration'}: ${avgDuration} d√≠as`, 20, 95);
                                            doc.text(`${language === 'es' ? 'Total de ciclos registrados' : 'Total cycles recorded'}: ${periodLog.length}`, 20, 105);
                                            
                                            doc.save(`Lumera_Periodo_${new Date().toISOString().split('T')[0]}.pdf`);
                                        }} className="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700">
                                            üì• {language === 'es' ? 'Descargar PDF' : 'Download PDF'}
                                        </button>
                                    </div>
                                    <canvas ref={chartRefPeriod} style={{maxHeight: '300px'}}></canvas>
                                </div>

                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                    <h3 className="font-semibold text-lg mb-4">{language === 'es' ? 'Tu Historial' : 'Your History'}</h3>
                                    <div className="space-y-3">
                                        {periodLog.map((p, idx) => (
                                            <div key={idx} className={`${darkMode ? 'bg-gray-700' : 'bg-gray-50'} p-4 rounded-lg`}>
                                                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-2`}>{p.date}</p>
                                                <p className="text-sm"><span className="font-semibold">{language === 'es' ? 'Intensidad' : 'Intensity'}:</span> {p.intensity}/10 | <span className="font-semibold">{language === 'es' ? 'Duraci√≥n' : 'Duration'}:</span> {p.duration} d√≠as</p>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </>
                        )}
                    </div>
                );
            };

            // MITOS
            const renderMyths = () => {
                const { myths } = getMythsAndTips();
                
                return (
                    <div className="pb-32 space-y-6" key={`myths-${language}`}>
                        <h2 className="text-3xl font-light gradient-text">{t[language].myths}</h2>
                        
                        {myths && Array.isArray(myths) && myths.length > 0 ? myths.map((myth, idx) => (
                            <div key={idx} className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg overflow-hidden`}>
                                <div className="bg-red-50 dark:bg-red-900 border-l-4 border-red-600 p-6">
                                    <h3 className={`text-lg font-semibold ${darkMode ? 'text-red-300' : 'text-red-900'} mb-2`}>‚ùå {myth.myth}</h3>
                                </div>
                                
                                <div className="p-6 space-y-4">
                                    <div className={`${darkMode ? 'bg-gray-700' : 'bg-green-50'} border-l-4 border-green-600 p-4 rounded-lg`}>
                                        <p className={`font-semibold ${darkMode ? 'text-green-300' : 'text-green-900'} mb-2`}>‚úÖ {myth.truth}</p>
                                    </div>

                                    <div className={`${darkMode ? 'bg-gray-700' : 'bg-blue-50'} border-l-4 border-blue-600 p-4 rounded-lg`}>
                                        <p className={`font-semibold mb-2 ${darkMode ? 'text-blue-300' : 'text-blue-900'}`}>üî¨ {language === 'es' ? 'Base Cient√≠fica' : 'Science'}</p>
                                        <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>{myth.science}</p>
                                    </div>

                                    <div className={`${darkMode ? 'bg-gray-700' : 'bg-purple-50'} border-l-4 border-purple-600 p-4 rounded-lg`}>
                                        <p className={`font-semibold mb-2 ${darkMode ? 'text-purple-300' : 'text-purple-900'}`}>üí° {language === 'es' ? 'Qu√© Hacer' : 'What to Do'}</p>
                                        <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>{myth.action}</p>
                                    </div>
                                </div>
                            </div>
                        )) : (
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                <p className="text-gray-600 dark:text-gray-400">{language === 'es' ? 'Cargando mitos...' : 'Loading myths...'}</p>
                            </div>
                        )}
                    </div>
                );
            };

            // CONSEJOS
            const renderTips = () => {
                const { tips } = getMythsAndTips();
                
                return (
                    <div className="pb-32 space-y-6" key={`tips-${language}`}>
                        <h2 className="text-3xl font-light gradient-text">{t[language].tips}</h2>
                        
                        {tips.map((tip, idx) => (
                            <div key={idx} className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg overflow-hidden`}>
                                <div className="bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6">
                                    <h3 className="text-2xl font-semibold">{tip.emoji} {tip.title}</h3>
                                </div>

                                <div className="p-6 space-y-4">
                                    <div className={`${darkMode ? 'bg-gray-700' : 'bg-yellow-50'} border-l-4 border-yellow-500 p-4 rounded-lg`}>
                                        <p className={`font-semibold mb-2 ${darkMode ? 'text-yellow-300' : 'text-yellow-900'}`}>üí° {language === 'es' ? 'Por qu√© es importante' : 'Why it matters'}</p>
                                        <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>{tip.why}</p>
                                    </div>

                                    <div className={`${darkMode ? 'bg-gray-700' : 'bg-green-50'} border-l-4 border-green-600 p-4 rounded-lg`}>
                                        <p className={`font-semibold mb-2 ${darkMode ? 'text-green-300' : 'text-green-900'}`}>‚úÖ {language === 'es' ? 'C√≥mo hacerlo' : 'How to do it'}</p>
                                        <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'} whitespace-pre-line`}>{tip.how}</p>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                );
            };

            // TALLERES
            const renderWorkshops = () => {
                return (
                    <div className="pb-32 space-y-6" key={`workshops-${language}`}>
                        <h2 className="text-3xl font-light gradient-text">{t[language].workshops}</h2>
                        <div className="grid md:grid-cols-2 gap-6">
                            {[
                                { title: language === 'es' ? 'Nutrici√≥n sin Culpa' : 'Nutrition Without Guilt', date: '15 Dic', type: 'webinar' },
                                { title: language === 'es' ? 'Ejercicio que Empodera' : 'Empowering Exercise', date: '20 Dic', type: 'workshop' }
                            ].map((w, idx) => (
                                <div key={idx} className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                    <h3 className="text-xl font-semibold mb-4">{w.title}</h3>
                                    <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-4`}>üìÖ {w.date}</p>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            // COMUNIDAD
            const renderCommunity = () => {
                return (
                    <div className="pb-32 space-y-8" key={`community-${language}`}>
                        <h2 className="text-3xl font-light gradient-text">{t[language].community}</h2>
                        
                        <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                            <h3 className="font-semibold text-lg mb-4">{language === 'es' ? 'üíú Comparte tu Historia' : 'üíú Share Your Story'}</h3>
                            <textarea value={communityMessage} onChange={(e) => setCommunityMessage(e.target.value)} placeholder={language === 'es' ? 'Cu√©ntanos c√≥mo te sientes...' : 'Tell us how you feel...'} className={`w-full px-4 py-3 border rounded-lg mb-4 resize-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300'}`} rows="4"/>
                            <button onClick={() => {
                                if (communityMessage.trim()) {
                                    setUserMessages([...userMessages, { name: currentUser.profileName, story: communityMessage, date: new Date().toLocaleDateString() }]);
                                    setCommunityMessage('');
                                    alert(language === 'es' ? '¬°Mensaje compartido! üíú' : 'Message shared! üíú');
                                }
                            }} className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:shadow-lg">
                                {language === 'es' ? 'Compartir Mensaje' : 'Share Message'}
                            </button>
                        </div>

                        {userMessages.length > 0 && (
                            <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-lg p-6`}>
                                <h3 className="font-semibold text-lg mb-6">{language === 'es' ? 'Historias de Nuestra Comunidad' : 'Community Stories'}</h3>
                                <div className="grid md:grid-cols-2 gap-6">
                                    {userMessages.map((msg, idx) => (
                                        <div key={idx} className={`${darkMode ? 'bg-gray-700' : 'bg-purple-50'} rounded-xl p-6 border-l-4 border-purple-600`}>
                                            <h4 className="font-semibold mb-2">üë© {msg.name}</h4>
                                            <p className={`italic ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-3`}>"{msg.story}"</p>
                                            <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>üìÖ {msg.date}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            // RENDERIZAR CONTENIDO
            const renderContent = () => {
                if (!currentUser) return null;
                
                // P√°ginas premium que requieren suscripci√≥n
                const premiumPages = ['nutrition', 'exercise', 'symptoms', 'period', 'workshops', 'community'];
                
                if (premiumPages.includes(currentPage) && !isPremium()) {
                    return (
                        <div className="text-center py-20">
                            <div className="mb-6">
                                <div className="inline-block p-8 bg-gradient-to-br from-purple-100 to-pink-100 rounded-full mb-6">
                                    <svg className="w-24 h-24 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                    </svg>
                                </div>
                            </div>
                            <h2 className="text-3xl font-bold mb-4 gradient-text">{language === 'es' ? 'Contenido Premium' : 'Premium Content'}</h2>
                            <p className="text-xl text-gray-600 mb-8 max-w-md mx-auto">
                                {language === 'es' ? 'Desbloquea todas las funcionalidades de Lumera' : 'Unlock all Lumera features'}
                            </p>
                            <div className="max-w-md mx-auto bg-white rounded-2xl shadow-xl p-8 mb-6">
                                <div className="mb-6">
                                    <div className="text-5xl font-bold gradient-text mb-2">{PRICES[getRegion()].price}</div>
                                    <div className="text-sm text-gray-600">{language === 'es' ? 'por mes' : 'per month'}</div>
                                </div>
                                <ul className="text-left space-y-3 mb-8">
                                    <li className="flex items-start">
                                        <svg className="w-6 h-6 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                                        </svg>
                                        <span>{language === 'es' ? 'Men√∫s personalizados semanales' : 'Personalized weekly menus'}</span>
                                    </li>
                                    <li className="flex items-start">
                                        <svg className="w-6 h-6 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                                        </svg>
                                        <span>{language === 'es' ? 'Rutinas de ejercicio adaptadas' : 'Adapted exercise routines'}</span>
                                    </li>
                                    <li className="flex items-start">
                                        <svg className="w-6 h-6 text-green-500 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                                        </svg>
                                        <span>{language === 'es' ? 'Seguimiento de s√≠ntomas y an√°lisis' : 'Symptom tracking and analysis'}</span>
                                    </li>
                                </ul>
                                <button onClick={handleSubscribe} className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-4 rounded-lg font-semibold text-lg hover:shadow-lg">
                                    üíé {language === 'es' ? 'Suscribirme' : 'Subscribe'}
                                </button>
                            </div>
                        </div>
                    );
                }
                
                switch(currentPage) {
                    case 'home': return renderHome();
                    case 'nutrition': return renderNutrition();
                    case 'exercise': return renderExercise();
                    case 'symptoms': return renderSymptoms();
                    case 'period': return renderPeriod();
                    case 'myths': return renderMyths();
                    case 'tips': return renderTips();
                    case 'workshops': return renderWorkshops();
                    case 'community': return renderCommunity();
                    default: return renderHome();
                }
            };

            if (loading) return <div className="min-h-screen bg-gradient-to-br from-purple-100 to-pink-50 flex items-center justify-center"><h1 className="text-4xl gradient-text">Lumera</h1></div>;
            
            // DEBUG: Ver estado actual
            console.log('RENDER STATE:', { showAuth, showQuiz, session: !!session, currentUser: !!currentUser });
            
            if (showAuth) return (
                <div className="min-h-screen bg-gradient-to-br from-purple-100 to-pink-50 flex items-center justify-center p-4">
                    <div className="bg-white rounded-2xl shadow-2xl p-12 max-w-md w-full">
                        <h1 className="text-4xl font-light gradient-text mb-8 text-center">Lumera</h1>
                        <div className="flex gap-2 mb-6">
                            <button onClick={() => setAuthMode('login')} className={`flex-1 py-2 rounded-lg font-semibold ${authMode === 'login' ? 'bg-purple-600 text-white' : 'bg-gray-200'}`}>{language === 'es' ? 'Iniciar Sesi√≥n' : 'Login'}</button>
                            <button onClick={() => setAuthMode('register')} className={`flex-1 py-2 rounded-lg font-semibold ${authMode === 'register' ? 'bg-purple-600 text-white' : 'bg-gray-200'}`}>{language === 'es' ? 'Registrarse' : 'Register'}</button>
                        </div>
                        <div className="space-y-4 mb-6">
                            <input type="email" placeholder="Email" value={authData.email} onChange={(e) => setAuthData({...authData, email: e.target.value})} className="w-full px-4 py-3 border rounded-lg"/>
                            <input type="password" placeholder="Password" value={authData.password} onChange={(e) => setAuthData({...authData, password: e.target.value})} className="w-full px-4 py-3 border rounded-lg"/>
                        </div>
                        
                        {authMode === 'register' && (
                            <div className="mb-6 space-y-3 text-xs text-gray-700 bg-gray-50 p-4 rounded-lg border">
                                <p className="font-semibold text-sm text-purple-900">
                                    {language === 'es' ? '‚ö†Ô∏è Antes de registrarte:' : '‚ö†Ô∏è Before registering:'}
                                </p>
                                <label className="flex items-start gap-2">
                                    <input type="checkbox" required className="mt-1"/>
                                    <span>{language === 'es' 
                                        ? 'Confirmo que soy mayor de 18 a√±os.' 
                                        : 'I confirm I am over 18 years old.'}</span>
                                </label>
                                <label className="flex items-start gap-2">
                                    <input type="checkbox" required className="mt-1"/>
                                    <span>{language === 'es' 
                                        ? 'Entiendo que Lumera es una herramienta de bienestar y NO sustituye consejo m√©dico profesional.' 
                                        : 'I understand that Lumera is a wellness tool and does NOT replace professional medical advice.'}</span>
                                </label>
                                <label className="flex items-start gap-2">
                                    <input type="checkbox" required className="mt-1"/>
                                    <span>{language === 'es' 
                                        ? 'Acepto que mis datos de salud se almacenar√°n de forma segura y encriptada. ' 
                                        : 'I accept that my health data will be stored securely and encrypted. '}
                                        <a href="mailto:privacy@lumera.app" className="text-purple-600 underline">privacy@lumera.app</a>
                                    </span>
                                </label>
                            </div>
                        )}
                        
                        <button onClick={authMode === 'login' ? handleLogin : handleRegister} className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-semibold">{authMode === 'login' ? 'Entrar' : 'Crear Cuenta'}</button>
                        <button onClick={() => setLanguage(language === 'es' ? 'en' : 'es')} className="w-full mt-4 text-sm text-gray-600">{language === 'es' ? 'üá¨üáß English' : 'üá™üá∏ Espa√±ol'}</button>
                    </div>
                </div>
            );
            
            // IMPORTANTE: Solo mostrar quiz si hay sesi√≥n v√°lida
            if (showQuiz && session) return renderQuiz();
            
            // Si showQuiz es true pero no hay sesi√≥n, forzar auth
            if (showQuiz && !session) {
                setShowQuiz(false);
                setShowAuth(true);
                return null;
            }

            return (
                <div className={darkMode ? 'bg-gray-900 text-white' : 'bg-gray-50'}>
                    <header className={`${darkMode ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-200'} shadow sticky top-0 z-40 border-b`}>
                        <div className="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <svg width="32" height="32" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                                    <defs>
                                        <linearGradient id="flameGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                            <stop offset="0%" style={{stopColor:'#d4af7f',stopOpacity:1}} />
                                            <stop offset="100%" style={{stopColor:'#e8c89f',stopOpacity:1}} />
                                        </linearGradient>
                                    </defs>
                                    <path d="M 32 12 A 20 20 0 0 0 32 52 A 16 16 0 0 1 32 16 Z" fill="#b8a8d8"/>
                                    <path d="M 40 32 Q 40 26 42 22 Q 42 28 40 35 Q 38 28 38 22 Q 40 26 40 32" fill="url(#flameGrad)"/>
                                </svg>
                                <h1 className="text-2xl font-light gradient-text">Lumera</h1>
                            </div>
                            <div className="flex items-center gap-3">
                                <select value={language} onChange={(e) => setLanguage(e.target.value)} className={`px-3 py-2 rounded text-sm border ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'bg-gray-100 border-gray-300'}`}>
                                    <option value="es">üá™üá∏</option>
                                    <option value="en">üá¨üáß</option>
                                </select>
                                <button onClick={() => setDarkMode(!darkMode)} className={`px-3 py-2 rounded text-sm ${darkMode ? 'bg-yellow-500 text-black' : 'bg-gray-200'}`}>
                                    {darkMode ? '‚òÄÔ∏è' : 'üåô'}
                                </button>
                                {!isPremium() && <button onClick={handleSubscribe} className="px-4 py-2 rounded text-sm font-semibold bg-gradient-to-r from-purple-600 to-pink-600 text-white">üíé Premium</button>}
                                <button onClick={handleLogout} className="text-sm text-gray-600 dark:text-gray-400">{language === 'es' ? 'Salir' : 'Exit'}</button>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-6xl mx-auto px-4 py-8" key={`content-${currentPage}-${language}`}>
                        {renderContent()}
                    </main>

                    {/* Footer con disclaimer y enlaces legales */}
                    <footer className={`${darkMode ? 'bg-gray-800 border-gray-700' : 'bg-gray-50 border-gray-200'} border-t py-6 mb-20`}>
                        <div className="max-w-6xl mx-auto px-4">
                            <div className="text-center mb-4">
                                <p className="text-xs text-gray-600 dark:text-gray-400 mb-2">
                                    {language === 'es'
                                        ? '‚ö†Ô∏è Lumera es una herramienta de bienestar, no sustituye consejo m√©dico profesional.'
                                        : '‚ö†Ô∏è Lumera is a wellness tool, not a substitute for professional medical advice.'}
                                </p>
                                <div className="flex justify-center gap-4 text-xs">
                                    <a href="mailto:support@lumera.app" className="text-purple-600 hover:underline">
                                        {language === 'es' ? 'Soporte' : 'Support'}
                                    </a>
                                    <a href="mailto:privacy@lumera.app" className="text-purple-600 hover:underline">
                                        {language === 'es' ? 'Privacidad' : 'Privacy'}
                                    </a>
                                    <a href="mailto:hello@lumera.app" className="text-purple-600 hover:underline">
                                        {language === 'es' ? 'Contacto' : 'Contact'}
                                    </a>
                                </div>
                            </div>
                            <p className="text-xs text-center text-gray-500">
                                ¬© 2025 Lumera. {language === 'es' ? 'Todos los derechos reservados.' : 'All rights reserved.'}
                            </p>
                        </div>
                    </footer>

                    <nav className={`fixed bottom-0 left-0 right-0 ${darkMode ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-200'} border-t shadow-lg`}>
                        <div className="max-w-6xl mx-auto flex justify-around overflow-x-auto">
                            {[
                                { page: 'home', label: t[language].home, emoji: 'üìä', premium: false },
                                { page: 'nutrition', label: t[language].nutrition, emoji: 'ü•ó', premium: true },
                                { page: 'exercise', label: t[language].exercise, emoji: 'üí™', premium: true },
                                { page: 'symptoms', label: t[language].symptoms, emoji: 'üìù', premium: true },
                                { page: 'period', label: t[language].period, emoji: 'üìÖ', premium: true },
                                { page: 'myths', label: t[language].myths, emoji: '‚ùå', premium: false },
                                { page: 'tips', label: t[language].tips, emoji: '‚ú®', premium: false },
                                { page: 'community', label: t[language].community, emoji: 'üíú', premium: true }
                            ].map((item) => (
                                <button key={item.page} onClick={() => setCurrentPage(item.page)}
                                    className={`py-4 px-3 text-xs sm:text-sm border-t-4 transition whitespace-nowrap ${
                                        currentPage === item.page
                                            ? `border-purple-600 ${darkMode ? 'bg-gray-700' : 'bg-purple-50'} text-purple-600`
                                            : `${darkMode ? 'border-gray-700 text-gray-400' : 'border-gray-200 text-gray-600'}`
                                    }`}>
                                    <div>{item.emoji}{item.premium && !isPremium() && ' üîí'}</div>
                                    <div className="hidden sm:block text-xs">{item.label}</div>
                                </button>
                            ))}
                        </div>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<LumeraApp />);
    </script>
</body>
</html>
